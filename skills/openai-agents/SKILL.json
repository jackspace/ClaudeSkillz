{
  "description": "|",
  "metadata": {
    "license": "MIT"
  },
  "references": {
    "files": [
      "references/agent-patterns.md",
      "references/cloudflare-integration.md",
      "references/common-errors.md",
      "references/official-links.md",
      "references/realtime-transports.md"
    ]
  },
  "content": "Complete skill for building AI applications with OpenAI Agents SDK (JavaScript/TypeScript), covering text agents, realtime voice agents, multi-agent workflows, and production deployment patterns.\r\n\r\n---",
  "name": "openai-agents",
  "id": "openai-agents",
  "sections": {
    "Orchestration Patterns": "### LLM-Based\r\n\r\nAgent decides routing autonomously:\r\n\r\n```typescript\r\nconst manager = Agent.create({\r\n  instructions: 'Analyze request and route to appropriate agent',\r\n  handoffs: [agent1, agent2, agent3],\r\n});\r\n```\r\n\r\n**Pros**: Adaptive, handles complexity\r\n**Cons**: Less predictable, higher tokens\r\n\r\n### Code-Based\r\n\r\nExplicit control flow:\r\n\r\n```typescript\r\nconst summary = await run(summarizerAgent, text);\r\nconst sentiment = await run(sentimentAgent, summary.finalOutput);\r\n\r\nif (sentiment.finalOutput.score < 0.3) {\r\n  await run(escalationAgent, text);\r\n}\r\n```\r\n\r\n**Pros**: Predictable, lower cost\r\n**Cons**: Less flexible\r\n\r\n### Parallel\r\n\r\nRun multiple agents concurrently:\r\n\r\n```typescript\r\nconst [summary, keywords, entities] = await Promise.all([\r\n  run(summarizerAgent, text),\r\n  run(keywordAgent, text),\r\n  run(entityAgent, text),\r\n]);\r\n```\r\n\r\n**Template**: `templates/text-agents/agent-parallel.ts`\r\n\r\n**References**: `references/agent-patterns.md`\r\n\r\n---",
    "Installation & Setup": "Install required packages:\r\n\r\n```bash\r\nnpm install @openai/agents zod@3\r\nnpm install @openai/agents-realtime  # For voice agents\r\n```\r\n\r\nSet environment variable:\r\n\r\n```bash\r\nexport OPENAI_API_KEY=\"your-api-key\"\r\n```\r\n\r\nSupported runtimes:\r\n- Node.js 22+\r\n- Deno\r\n- Bun\r\n- Cloudflare Workers (experimental)\r\n\r\n---",
    "References": "1. `agent-patterns.md` - Orchestration strategies\r\n2. `common-errors.md` - 9 errors with workarounds\r\n3. `realtime-transports.md` - WebRTC vs WebSocket\r\n4. `cloudflare-integration.md` - Workers limitations\r\n5. `official-links.md` - Documentation links\r\n\r\n---",
    "Framework Integration": "### Cloudflare Workers (Experimental)\r\n\r\n```typescript\r\nimport { Agent, run } from '@openai/agents';\r\n\r\nexport default {\r\n  async fetch(request: Request, env: Env) {\r\n    const { message } = await request.json();\r\n\r\n    process.env.OPENAI_API_KEY = env.OPENAI_API_KEY;\r\n\r\n    const agent = new Agent({\r\n      name: 'Assistant',\r\n      instructions: 'Be helpful and concise',\r\n      model: 'gpt-4o-mini',\r\n    });\r\n\r\n    const result = await run(agent, message, {\r\n      maxTurns: 5,\r\n    });\r\n\r\n    return new Response(JSON.stringify({\r\n      response: result.finalOutput,\r\n      tokens: result.usage.totalTokens,\r\n    }), {\r\n      headers: { 'Content-Type': 'application/json' },\r\n    });\r\n  },\r\n};\r\n```\r\n\r\n**Limitations**:\r\n- No realtime voice agents\r\n- CPU time limits (30s max)\r\n- Memory constraints (128MB)\r\n\r\n**Templates**:\r\n- `templates/cloudflare-workers/worker-text-agent.ts`\r\n- `templates/cloudflare-workers/worker-agent-hono.ts`\r\n\r\n**References**:\r\n- `references/cloudflare-integration.md`\r\n\r\n### Next.js App Router\r\n\r\n```typescript\r\n// app/api/agent/route.ts\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { Agent, run } from '@openai/agents';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  const { message } = await request.json();\r\n\r\n  const agent = new Agent({\r\n    name: 'Assistant',\r\n    instructions: 'Be helpful',\r\n  });\r\n\r\n  const result = await run(agent, message);\r\n\r\n  return NextResponse.json({\r\n    response: result.finalOutput,\r\n  });\r\n}\r\n```\r\n\r\n**Templates**:\r\n- `templates/nextjs/api-agent-route.ts`\r\n- `templates/nextjs/api-realtime-route.ts`\r\n\r\n---",
    "Error Handling (9+ Errors Prevented)": "### 1. Zod Schema Type Errors\r\n\r\n**Error**: Type errors with tool parameters.\r\n\r\n**Workaround**: Define schemas inline.\r\n\r\n```typescript\r\n// ❌ Can cause type errors\r\nparameters: mySchema\r\n\r\n// ✅ Works reliably\r\nparameters: z.object({ field: z.string() })\r\n```\r\n\r\n**Source**: [GitHub #188](https://github.com/openai/openai-agents-js/issues/188)\r\n\r\n### 2. MCP Tracing Errors\r\n\r\n**Error**: \"No existing trace found\" with MCP servers.\r\n\r\n**Workaround**:\r\n```typescript\r\nimport { initializeTracing } from '@openai/agents/tracing';\r\nawait initializeTracing();\r\n```\r\n\r\n**Source**: [GitHub #580](https://github.com/openai/openai-agents-js/issues/580)\r\n\r\n### 3. MaxTurnsExceededError\r\n\r\n**Error**: Agent loops infinitely.\r\n\r\n**Solution**: Increase maxTurns or improve instructions:\r\n\r\n```typescript\r\nconst result = await run(agent, input, {\r\n  maxTurns: 20, // Increase limit\r\n});\r\n\r\n// Or improve instructions\r\ninstructions: `After using tools, provide a final answer.\r\nDo not loop endlessly.`\r\n```\r\n\r\n### 4. ToolCallError\r\n\r\n**Error**: Tool execution fails.\r\n\r\n**Solution**: Retry with exponential backoff:\r\n\r\n```typescript\r\nfor (let attempt = 1; attempt <= 3; attempt++) {\r\n  try {\r\n    return await run(agent, input);\r\n  } catch (error) {\r\n    if (error instanceof ToolCallError && attempt < 3) {\r\n      await sleep(1000 * Math.pow(2, attempt - 1));\r\n      continue;\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n```\r\n\r\n### 5. Schema Mismatch\r\n\r\n**Error**: Output doesn't match `outputType`.\r\n\r\n**Solution**: Use stronger model or add validation instructions:\r\n\r\n```typescript\r\nconst agent = new Agent({\r\n  model: 'gpt-4o', // More reliable than gpt-4o-mini\r\n  instructions: 'CRITICAL: Return JSON matching schema exactly',\r\n  outputType: mySchema,\r\n});\r\n```\r\n\r\n**All Errors**: See `references/common-errors.md`\r\n\r\n**Template**: `templates/shared/error-handling.ts`\r\n\r\n---",
    "Core Concepts": "### 1. Agents\r\nLLMs equipped with instructions and tools:\r\n\r\n```typescript\r\nimport { Agent } from '@openai/agents';\r\n\r\nconst agent = new Agent({\r\n  name: 'Assistant',\r\n  instructions: 'You are helpful.',\r\n  tools: [myTool],\r\n  model: 'gpt-4o-mini',\r\n});\r\n```\r\n\r\n### 2. Tools\r\nFunctions agents can call, with automatic schema generation:\r\n\r\n```typescript\r\nimport { tool } from '@openai/agents';\r\nimport { z } from 'zod';\r\n\r\nconst weatherTool = tool({\r\n  name: 'get_weather',\r\n  description: 'Get weather for a city',\r\n  parameters: z.object({\r\n    city: z.string(),\r\n  }),\r\n  execute: async ({ city }) => {\r\n    return `Weather in ${city}: sunny`;\r\n  },\r\n});\r\n```\r\n\r\n### 3. Handoffs\r\nMulti-agent delegation:\r\n\r\n```typescript\r\nconst specialist = new Agent({ /* ... */ });\r\n\r\nconst triageAgent = Agent.create({\r\n  name: 'Triage',\r\n  instructions: 'Route to specialists',\r\n  handoffs: [specialist],\r\n});\r\n```\r\n\r\n### 4. Guardrails\r\nInput/output validation for safety:\r\n\r\n```typescript\r\nconst agent = new Agent({\r\n  inputGuardrails: [homeworkDetector],\r\n  outputGuardrails: [piiFilter],\r\n});\r\n```\r\n\r\n### 5. Structured Outputs\r\nType-safe responses with Zod:\r\n\r\n```typescript\r\nconst agent = new Agent({\r\n  outputType: z.object({\r\n    sentiment: z.enum(['positive', 'negative', 'neutral']),\r\n    confidence: z.number(),\r\n  }),\r\n});\r\n```\r\n\r\n---",
    "When to Use This Skill": "✅ **Use when**:\r\n- Building multi-agent workflows\r\n- Creating voice AI applications\r\n- Implementing tool-calling patterns\r\n- Requiring input/output validation (guardrails)\r\n- Needing human approval gates\r\n- Orchestrating complex AI tasks\r\n- Deploying to Cloudflare Workers or Next.js\r\n\r\n❌ **Don't use when**:\r\n- Simple OpenAI API calls (use `openai-api` skill instead)\r\n- Non-OpenAI models exclusively\r\n- Production voice at massive scale (consider LiveKit Agents)\r\n\r\n---",
    "Official Resources": "- **Docs**: https://openai.github.io/openai-agents-js/\r\n- **GitHub**: https://github.com/openai/openai-agents-js\r\n- **npm**: https://www.npmjs.com/package/@openai/agents\r\n- **Issues**: https://github.com/openai/openai-agents-js/issues\r\n\r\n---\r\n\r\n**Version**: SDK v0.2.1\r\n**Last Verified**: 2025-10-26\r\n**Skill Author**: Jeremy Dawes (Jezweb)\r\n**Production Tested**: Yes",
    "Human-in-the-Loop": "Require approval for specific actions:\r\n\r\n```typescript\r\nconst refundTool = tool({\r\n  name: 'process_refund',\r\n  requiresApproval: true,  // ← Requires human approval\r\n  execute: async ({ amount }) => {\r\n    return `Refunded $${amount}`;\r\n  },\r\n});\r\n\r\n// Handle approval requests\r\nlet result = await runner.run(input);\r\n\r\nwhile (result.interruption) {\r\n  if (result.interruption.type === 'tool_approval') {\r\n    const approved = await promptUser(result.interruption);\r\n    result = approved\r\n      ? await result.state.approve(result.interruption)\r\n      : await result.state.reject(result.interruption);\r\n  }\r\n}\r\n```\r\n\r\n**Templates**:\r\n- `templates/text-agents/agent-human-approval.ts`\r\n\r\n---",
    "Production Checklist": "- [ ] Set `OPENAI_API_KEY` as environment secret\r\n- [ ] Implement error handling for all agent calls\r\n- [ ] Add guardrails for safety-critical applications\r\n- [ ] Enable tracing for debugging\r\n- [ ] Set reasonable `maxTurns` to prevent runaway costs\r\n- [ ] Use `gpt-4o-mini` where possible for cost efficiency\r\n- [ ] Implement rate limiting\r\n- [ ] Log token usage for cost monitoring\r\n- [ ] Test handoff flows thoroughly\r\n- [ ] Never expose API keys to browsers (use session tokens)\r\n\r\n---",
    "Multi-Agent Handoffs": "Create specialized agents and route between them:\r\n\r\n```typescript\r\nconst billingAgent = new Agent({\r\n  name: 'Billing',\r\n  handoffDescription: 'For billing and payment questions',\r\n  tools: [processRefundTool],\r\n});\r\n\r\nconst techAgent = new Agent({\r\n  name: 'Technical',\r\n  handoffDescription: 'For technical issues',\r\n  tools: [createTicketTool],\r\n});\r\n\r\nconst triageAgent = Agent.create({\r\n  name: 'Triage',\r\n  instructions: 'Route customers to the right specialist',\r\n  handoffs: [billingAgent, techAgent],\r\n});\r\n```\r\n\r\n**Templates**:\r\n- `templates/text-agents/agent-handoffs.ts`\r\n\r\n**References**:\r\n- `references/agent-patterns.md` - LLM vs code orchestration\r\n\r\n---",
    "Token Efficiency": "**Estimated Savings**: ~60%\r\n\r\n| Task | Without Skill | With Skill | Savings |\r\n|------|---------------|------------|---------|\r\n| Multi-agent setup | ~12k tokens | ~5k tokens | 58% |\r\n| Voice agent | ~10k tokens | ~4k tokens | 60% |\r\n| Error debugging | ~8k tokens | ~3k tokens | 63% |\r\n| **Average** | **~10k** | **~4k** | **~60%** |\r\n\r\n**Errors Prevented**: 9 documented issues = 100% error prevention\r\n\r\n---",
    "Guardrails": "### Input Guardrails\r\n\r\nValidate input before processing:\r\n\r\n```typescript\r\nconst homeworkGuardrail: InputGuardrail = {\r\n  name: 'Homework Detection',\r\n  execute: async ({ input, context }) => {\r\n    const result = await run(guardrailAgent, input);\r\n    return {\r\n      tripwireTriggered: result.finalOutput.isHomework,\r\n      outputInfo: result.finalOutput,\r\n    };\r\n  },\r\n};\r\n\r\nconst agent = new Agent({\r\n  inputGuardrails: [homeworkGuardrail],\r\n});\r\n```\r\n\r\n### Output Guardrails\r\n\r\nFilter responses:\r\n\r\n```typescript\r\nconst piiGuardrail: OutputGuardrail = {\r\n  name: 'PII Detection',\r\n  execute: async ({ agentOutput }) => {\r\n    const phoneRegex = /\\b\\d{3}[-. ]?\\d{3}[-. ]?\\d{4}\\b/;\r\n    return {\r\n      tripwireTriggered: phoneRegex.test(agentOutput as string),\r\n      outputInfo: { detected: 'phone_number' },\r\n    };\r\n  },\r\n};\r\n```\r\n\r\n**Templates**:\r\n- `templates/text-agents/agent-guardrails-input.ts`\r\n- `templates/text-agents/agent-guardrails-output.ts`\r\n\r\n---",
    "Text Agents": "### Basic Usage\r\n\r\n```typescript\r\nimport { run } from '@openai/agents';\r\n\r\nconst result = await run(agent, 'What is 2+2?');\r\nconsole.log(result.finalOutput);\r\nconsole.log(result.usage.totalTokens);\r\n```\r\n\r\n### Streaming\r\n\r\n```typescript\r\nconst stream = await run(agent, 'Tell me a story', {\r\n  stream: true,\r\n});\r\n\r\nfor await (const event of stream) {\r\n  if (event.type === 'raw_model_stream_event') {\r\n    const chunk = event.data?.choices?.[0]?.delta?.content || '';\r\n    process.stdout.write(chunk);\r\n  }\r\n}\r\n```\r\n\r\n**Templates**:\r\n- `templates/text-agents/agent-basic.ts`\r\n- `templates/text-agents/agent-streaming.ts`\r\n\r\n---",
    "Debugging & Tracing": "Enable verbose logging:\r\n\r\n```typescript\r\nprocess.env.DEBUG = '@openai/agents:*';\r\n```\r\n\r\nAccess execution details:\r\n\r\n```typescript\r\nconst result = await run(agent, input);\r\n\r\nconsole.log('Tokens:', result.usage.totalTokens);\r\nconsole.log('Turns:', result.history.length);\r\nconsole.log('Current Agent:', result.currentAgent?.name);\r\n```\r\n\r\n**Template**: `templates/shared/tracing-setup.ts`\r\n\r\n---",
    "Realtime Voice Agents": "### Creating Voice Agents\r\n\r\n```typescript\r\nimport { RealtimeAgent, tool } from '@openai/agents-realtime';\r\n\r\nconst voiceAgent = new RealtimeAgent({\r\n  name: 'Voice Assistant',\r\n  instructions: 'Keep responses concise for voice',\r\n  tools: [weatherTool],\r\n  voice: 'alloy', // alloy, echo, fable, onyx, nova, shimmer\r\n  model: 'gpt-4o-realtime-preview',\r\n});\r\n```\r\n\r\n### Browser Session (React)\r\n\r\n```typescript\r\nimport { RealtimeSession } from '@openai/agents-realtime';\r\n\r\nconst session = new RealtimeSession(voiceAgent, {\r\n  apiKey: sessionApiKey, // From your backend!\r\n  transport: 'webrtc', // or 'websocket'\r\n});\r\n\r\nsession.on('connected', () => console.log('Connected'));\r\nsession.on('audio.transcription.completed', (e) => console.log('User:', e.transcript));\r\nsession.on('agent.audio.done', (e) => console.log('Agent:', e.transcript));\r\n\r\nawait session.connect();\r\n```\r\n\r\n**CRITICAL**: Never send your main OPENAI_API_KEY to the browser! Generate ephemeral session tokens server-side.\r\n\r\n### Voice Agent Handoffs\r\n\r\nVoice agents support handoffs with constraints:\r\n- **Cannot change voice** during handoff\r\n- **Cannot change model** during handoff\r\n- Conversation history automatically passed\r\n\r\n```typescript\r\nconst specialist = new RealtimeAgent({\r\n  voice: 'nova', // Must match parent\r\n  /* ... */\r\n});\r\n\r\nconst triageAgent = new RealtimeAgent({\r\n  voice: 'nova',\r\n  handoffs: [specialist],\r\n});\r\n```\r\n\r\n**Templates**:\r\n- `templates/realtime-agents/realtime-agent-basic.ts`\r\n- `templates/realtime-agents/realtime-session-browser.tsx`\r\n- `templates/realtime-agents/realtime-handoffs.ts`\r\n\r\n**References**:\r\n- `references/realtime-transports.md` - WebRTC vs WebSocket\r\n\r\n---",
    "Templates Index": "**Text Agents** (8):\r\n1. `agent-basic.ts` - Simple agent with tools\r\n2. `agent-handoffs.ts` - Multi-agent triage\r\n3. `agent-structured-output.ts` - Zod schemas\r\n4. `agent-streaming.ts` - Real-time events\r\n5. `agent-guardrails-input.ts` - Input validation\r\n6. `agent-guardrails-output.ts` - Output filtering\r\n7. `agent-human-approval.ts` - HITL pattern\r\n8. `agent-parallel.ts` - Concurrent execution\r\n\r\n**Realtime Agents** (3):\r\n9. `realtime-agent-basic.ts` - Voice setup\r\n10. `realtime-session-browser.tsx` - React client\r\n11. `realtime-handoffs.ts` - Voice delegation\r\n\r\n**Framework Integration** (4):\r\n12. `worker-text-agent.ts` - Cloudflare Workers\r\n13. `worker-agent-hono.ts` - Hono framework\r\n14. `api-agent-route.ts` - Next.js API\r\n15. `api-realtime-route.ts` - Next.js voice\r\n\r\n**Utilities** (2):\r\n16. `error-handling.ts` - Comprehensive errors\r\n17. `tracing-setup.ts` - Debugging\r\n\r\n---"
  }
}
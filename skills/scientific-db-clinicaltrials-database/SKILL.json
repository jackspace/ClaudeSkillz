{
  "description": "\"Query ClinicalTrials.gov via API v2. Search trials by condition, drug, location, status, or phase. Retrieve trial details by NCT ID, export data, for clinical research and patient matching.\"",
  "references": {
    "files": [
      "references/api_reference.md"
    ]
  },
  "content": "### Basic Search Query\r\n\r\nSearch for clinical trials using the helper script:\r\n\r\n```bash\r\ncd scientific-databases/clinicaltrials-database/scripts\r\npython3 query_clinicaltrials.py\r\n```\r\n\r\nOr use Python directly with the `requests` library:\r\n\r\n```python\r\nimport requests\r\n\r\nurl = \"https://clinicaltrials.gov/api/v2/studies\"\r\nparams = {\r\n    \"query.cond\": \"breast cancer\",\r\n    \"filter.overallStatus\": \"RECRUITING\",\r\n    \"pageSize\": 10\r\n}\r\n\r\nresponse = requests.get(url, params=params)\r\ndata = response.json()\r\n\r\nprint(f\"Found {data['totalCount']} trials\")\r\n```\r\n\r\n### Retrieve Specific Trial\r\n\r\nGet detailed information about a trial using its NCT ID:\r\n\r\n```python\r\nimport requests\r\n\r\nnct_id = \"NCT04852770\"\r\nurl = f\"https://clinicaltrials.gov/api/v2/studies/{nct_id}\"\r\n\r\nresponse = requests.get(url)\r\nstudy = response.json()\r\n\r\n\r\n### 1. Search by Condition/Disease\r\n\r\nFind trials studying specific medical conditions or diseases using the `query.cond` parameter.\r\n\r\n**Example: Find recruiting diabetes trials**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nresults = search_studies(\r\n    condition=\"type 2 diabetes\",\r\n    status=\"RECRUITING\",\r\n    page_size=20,\r\n    sort=\"LastUpdatePostDate:desc\"\r\n)\r\n\r\nprint(f\"Found {results['totalCount']} recruiting diabetes trials\")\r\nfor study in results['studies']:\r\n    protocol = study['protocolSection']\r\n    nct_id = protocol['identificationModule']['nctId']\r\n    title = protocol['identificationModule']['briefTitle']\r\n    print(f\"{nct_id}: {title}\")\r\n```\r\n\r\n**Common use cases:**\r\n- Finding trials for rare diseases\r\n- Identifying trials for comorbid conditions\r\n- Tracking trial availability for specific diagnoses\r\n\r\n### 2. Search by Intervention/Drug\r\n\r\nSearch for trials testing specific interventions, drugs, devices, or procedures using the `query.intr` parameter.\r\n\r\n**Example: Find Phase 3 trials testing Pembrolizumab**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nresults = search_studies(\r\n    intervention=\"Pembrolizumab\",\r\n    status=[\"RECRUITING\", \"ACTIVE_NOT_RECRUITING\"],\r\n    page_size=50\r\n)\r\n\r\nphase3_trials = [\r\n    study for study in results['studies']\r\n    if 'PHASE3' in study['protocolSection'].get('designModule', {}).get('phases', [])\r\n]\r\n```\r\n\r\n**Common use cases:**\r\n- Drug development tracking\r\n- Competitive intelligence for pharmaceutical companies\r\n- Treatment option research for clinicians\r\n\r\n### 3. Geographic Search\r\n\r\nFind trials in specific locations using the `query.locn` parameter.\r\n\r\n**Example: Find cancer trials in New York**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nresults = search_studies(\r\n    condition=\"cancer\",\r\n    location=\"New York\",\r\n    status=\"RECRUITING\",\r\n    page_size=100\r\n)\r\n\r\nfor study in results['studies']:\r\n    locations_module = study['protocolSection'].get('contactsLocationsModule', {})\r\n    locations = locations_module.get('locations', [])\r\n    for loc in locations:\r\n        if 'New York' in loc.get('city', ''):\r\n            print(f\"{loc['facility']}: {loc['city']}, {loc.get('state', '')}\")\r\n```\r\n\r\n**Common use cases:**\r\n- Patient referrals to local trials\r\n- Geographic trial distribution analysis\r\n- Site selection for new trials\r\n\r\n### 4. Search by Sponsor/Organization\r\n\r\nFind trials conducted by specific organizations using the `query.spons` parameter.\r\n\r\n**Example: Find trials sponsored by NCI**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nresults = search_studies(\r\n    sponsor=\"National Cancer Institute\",\r\n    page_size=100\r\n)\r\n\r\nfor study in results['studies']:\r\n    sponsor_module = study['protocolSection']['sponsorCollaboratorsModule']\r\n    lead_sponsor = sponsor_module['leadSponsor']['name']\r\n    collaborators = sponsor_module.get('collaborators', [])\r\n    print(f\"Lead: {lead_sponsor}\")\r\n    if collaborators:\r\n        print(f\"  Collaborators: {', '.join([c['name'] for c in collaborators])}\")\r\n```\r\n\r\n**Common use cases:**\r\n- Tracking institutional research portfolios\r\n- Analyzing funding organization priorities\r\n- Identifying collaboration opportunities\r\n\r\n### 5. Filter by Study Status\r\n\r\nFilter trials by recruitment or completion status using the `filter.overallStatus` parameter.\r\n\r\n**Valid status values:**\r\n- `RECRUITING` - Currently recruiting participants\r\n- `NOT_YET_RECRUITING` - Not yet open for recruitment\r\n- `ENROLLING_BY_INVITATION` - Only enrolling by invitation\r\n- `ACTIVE_NOT_RECRUITING` - Active but no longer recruiting\r\n- `SUSPENDED` - Temporarily halted\r\n- `TERMINATED` - Stopped prematurely\r\n- `COMPLETED` - Study has concluded\r\n- `WITHDRAWN` - Withdrawn prior to enrollment\r\n\r\n**Example: Find recently completed trials with results**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nresults = search_studies(\r\n    condition=\"alzheimer disease\",\r\n    status=\"COMPLETED\",\r\n    sort=\"LastUpdatePostDate:desc\",\r\n    page_size=50\r\n)\r\n\r\ntrials_with_results = [\r\n    study for study in results['studies']\r\n    if study.get('hasResults', False)\r\n]\r\n\r\nprint(f\"Found {len(trials_with_results)} completed trials with results\")\r\n```\r\n\r\n### 6. Retrieve Detailed Study Information\r\n\r\nGet comprehensive information about specific trials including eligibility criteria, outcomes, contacts, and locations.\r\n\r\n**Example: Extract eligibility criteria**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import get_study_details\r\n\r\nstudy = get_study_details(\"NCT04852770\")\r\neligibility = study['protocolSection']['eligibilityModule']\r\n\r\nprint(f\"Eligible Ages: {eligibility.get('minimumAge')} - {eligibility.get('maximumAge')}\")\r\nprint(f\"Eligible Sex: {eligibility.get('sex')}\")\r\nprint(f\"\\nInclusion Criteria:\")\r\nprint(eligibility.get('eligibilityCriteria'))\r\n```\r\n\r\n**Example: Extract contact information**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import get_study_details\r\n\r\nstudy = get_study_details(\"NCT04852770\")\r\ncontacts_module = study['protocolSection']['contactsLocationsModule']\r\n\r\nif 'centralContacts' in contacts_module:\r\n    for contact in contacts_module['centralContacts']:\r\n        print(f\"Contact: {contact.get('name')}\")\r\n        print(f\"Phone: {contact.get('phone')}\")\r\n        print(f\"Email: {contact.get('email')}\")\r\n\r\nif 'locations' in contacts_module:\r\n    for location in contacts_module['locations']:\r\n        print(f\"\\nFacility: {location.get('facility')}\")\r\n        print(f\"City: {location.get('city')}, {location.get('state')}\")\r\n        if location.get('status'):\r\n            print(f\"Status: {location['status']}\")\r\n```\r\n\r\n### 7. Pagination and Bulk Data Retrieval\r\n\r\nHandle large result sets efficiently using pagination.\r\n\r\n**Example: Retrieve all matching trials**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_with_all_results\r\n\r\nall_trials = search_with_all_results(\r\n    condition=\"rare disease\",\r\n    status=\"RECRUITING\"\r\n)\r\n\r\nprint(f\"Retrieved {len(all_trials)} total trials\")\r\n```\r\n\r\n**Example: Manual pagination with control**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nall_studies = []\r\npage_token = None\r\nmax_pages = 10  # Limit to avoid excessive requests\r\n\r\nfor page in range(max_pages):\r\n    results = search_studies(\r\n        condition=\"cancer\",\r\n        page_size=1000,  # Max page size\r\n        page_token=page_token\r\n    )\r\n\r\n    all_studies.extend(results['studies'])\r\n\r\n    # Check for next page\r\n    page_token = results.get('pageToken')\r\n    if not page_token:\r\n        break\r\n\r\nprint(f\"Retrieved {len(all_studies)} studies across {page + 1} pages\")\r\n```\r\n\r\n### 8. Data Export to CSV\r\n\r\nExport trial data to CSV format for analysis in spreadsheet software or data analysis tools.\r\n\r\n**Example: Export to CSV file**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nresults = search_studies(\r\n    condition=\"heart disease\",\r\n    status=\"RECRUITING\",\r\n    format=\"csv\",\r\n    page_size=1000\r\n)\r\n\r\nwith open(\"heart_disease_trials.csv\", \"w\") as f:\r\n    f.write(results)\r\n\r\nprint(\"Data exported to heart_disease_trials.csv\")\r\n```\r\n\r\n**Note:** CSV format returns a string instead of JSON dictionary.\r\n\r\n### 9. Extract and Summarize Study Information\r\n\r\nExtract key information for quick overview or reporting.\r\n\r\n**Example: Create trial summary**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import get_study_details, extract_study_summary\r\n\r\nstudy = get_study_details(\"NCT04852770\")\r\nsummary = extract_study_summary(study)\r\n\r\nprint(f\"NCT ID: {summary['nct_id']}\")\r\nprint(f\"Title: {summary['title']}\")\r\nprint(f\"Status: {summary['status']}\")\r\nprint(f\"Phase: {', '.join(summary['phase'])}\")\r\nprint(f\"Enrollment: {summary['enrollment']}\")\r\nprint(f\"Last Update: {summary['last_update']}\")\r\nprint(f\"\\nBrief Summary:\\n{summary['brief_summary']}\")\r\n```\r\n\r\n### 10. Combined Query Strategies\r\n\r\nCombine multiple filters for targeted searches.\r\n\r\n**Example: Multi-criteria search**\r\n\r\n```python\r\nfrom scripts.query_clinicaltrials import search_studies\r\n\r\nresults = search_studies(\r\n    condition=\"lung cancer\",\r\n    intervention=\"immunotherapy\",\r\n    location=\"California\",\r\n    status=[\"RECRUITING\", \"NOT_YET_RECRUITING\"],\r\n    page_size=100\r\n)\r\n\r\n\r\n### Rate Limit Management\r\n\r\nThe API has a rate limit of approximately 50 requests per minute. For bulk data retrieval:\r\n\r\n1. Use maximum page size (1000) to minimize requests\r\n2. Implement exponential backoff on rate limit errors (429 status)\r\n3. Add delays between requests for large-scale data collection\r\n\r\n```python\r\nimport time\r\nimport requests\r\n\r\ndef search_with_rate_limit(params):\r\n    try:\r\n        response = requests.get(\"https://clinicaltrials.gov/api/v2/studies\", params=params)\r\n        response.raise_for_status()\r\n        return response.json()\r\n    except requests.exceptions.HTTPError as e:\r\n        if e.response.status_code == 429:\r\n            print(\"Rate limited. Waiting 60 seconds...\")\r\n            time.sleep(60)\r\n            return search_with_rate_limit(params)  # Retry\r\n        raise\r\n```\r\n\r\n### Data Structure Navigation\r\n\r\nThe API response has a nested structure. Key paths to common information:\r\n\r\n- **NCT ID**: `study['protocolSection']['identificationModule']['nctId']`\r\n- **Title**: `study['protocolSection']['identificationModule']['briefTitle']`\r\n- **Status**: `study['protocolSection']['statusModule']['overallStatus']`\r\n- **Phase**: `study['protocolSection']['designModule']['phases']`\r\n- **Eligibility**: `study['protocolSection']['eligibilityModule']`\r\n- **Locations**: `study['protocolSection']['contactsLocationsModule']['locations']`\r\n- **Interventions**: `study['protocolSection']['armsInterventionsModule']['interventions']`\r\n\r\n### Error Handling\r\n\r\nAlways implement proper error handling for network requests:\r\n\r\n```python\r\nimport requests\r\n\r\ntry:\r\n    response = requests.get(url, params=params, timeout=30)\r\n    response.raise_for_status()\r\n    data = response.json()\r\nexcept requests.exceptions.HTTPError as e:\r\n    print(f\"HTTP error: {e.response.status_code}\")\r\nexcept requests.exceptions.RequestException as e:\r\n    print(f\"Request failed: {e}\")\r\nexcept ValueError as e:\r\n    print(f\"JSON decode error: {e}\")\r\n```\r\n\r\n### Handling Missing Data\r\n\r\nNot all trials have complete information. Always check for field existence:\r\n\r\n```python\r\nphases = study['protocolSection'].get('designModule', {}).get('phases', [])\r\nenrollment = study['protocolSection'].get('designModule', {}).get('enrollmentInfo', {}).get('count', 'N/A')",
  "name": "clinicaltrials-database",
  "id": "scientific-db-clinicaltrials-database",
  "sections": {
    "Quick Start": "title = study['protocolSection']['identificationModule']['briefTitle']\r\nstatus = study['protocolSection']['statusModule']['overallStatus']\r\n```",
    "Best Practices": "if 'resultsSection' in study:\r\n    # Process results\r\n    pass\r\n```",
    "Overview": "ClinicalTrials.gov is a comprehensive registry of clinical studies conducted worldwide, maintained by the U.S. National Library of Medicine. Access API v2 to search for trials, retrieve detailed study information, filter by various criteria, and export data for analysis. The API is public (no authentication required) with rate limits of ~50 requests per minute, supporting JSON and CSV formats.",
    "When to Use This Skill": "This skill should be used when working with clinical trial data in scenarios such as:\r\n\r\n- **Patient matching** - Finding recruiting trials for specific conditions or patient populations\r\n- **Research analysis** - Analyzing clinical trial trends, outcomes, or study designs\r\n- **Drug/intervention research** - Identifying trials testing specific drugs or interventions\r\n- **Geographic searches** - Locating trials in specific locations or regions\r\n- **Sponsor/organization tracking** - Finding trials conducted by specific institutions\r\n- **Data export** - Extracting clinical trial data for further analysis or reporting\r\n- **Trial monitoring** - Tracking status updates or results for specific trials\r\n- **Eligibility screening** - Reviewing inclusion/exclusion criteria for trials",
    "Resources": "### scripts/query_clinicaltrials.py\r\n\r\nComprehensive Python script providing helper functions for common query patterns:\r\n\r\n- `search_studies()` - Search for trials with various filters\r\n- `get_study_details()` - Retrieve full information for a specific trial\r\n- `search_with_all_results()` - Automatically paginate through all results\r\n- `extract_study_summary()` - Extract key information for quick overview\r\n\r\nRun the script directly for example usage:\r\n\r\n```bash\r\npython3 scripts/query_clinicaltrials.py\r\n```\r\n\r\n### references/api_reference.md\r\n\r\nDetailed API documentation including:\r\n\r\n- Complete endpoint specifications\r\n- All query parameters and valid values\r\n- Response data structure and modules\r\n- Common use cases with code examples\r\n- Error handling and best practices\r\n- Data standards (ISO 8601 dates, CommonMark markdown)\r\n\r\nLoad this reference when working with unfamiliar API features or troubleshooting issues.",
    "Core Capabilities": "phase2_3_trials = [\r\n    study for study in results['studies']\r\n    if any(phase in ['PHASE2', 'PHASE3']\r\n           for phase in study['protocolSection'].get('designModule', {}).get('phases', []))\r\n]\r\n\r\nprint(f\"Found {len(phase2_3_trials)} Phase 2/3 immunotherapy trials\")\r\n```",
    "Technical Specifications": "- **Base URL**: `https://clinicaltrials.gov/api/v2`\r\n- **Authentication**: Not required (public API)\r\n- **Rate Limit**: ~50 requests/minute per IP\r\n- **Response Formats**: JSON (default), CSV\r\n- **Max Page Size**: 1000 studies per request\r\n- **Date Format**: ISO 8601\r\n- **Text Format**: CommonMark Markdown for rich text fields\r\n- **API Version**: 2.0 (released March 2024)\r\n- **API Specification**: OpenAPI 3.0\r\n\r\nFor complete technical details, see `references/api_reference.md`."
  }
}
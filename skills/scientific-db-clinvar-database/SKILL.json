{
  "description": "\"Query NCBI ClinVar for variant clinical significance. Search by gene/position, interpret pathogenicity classifications, access via E-utilities API or FTP, annotate VCFs, for genomic medicine.\"",
  "references": {
    "files": [
      "references/api_reference.md",
      "references/clinical_significance.md",
      "references/data_formats.md"
    ]
  },
  "content": "### 1. Search and Query ClinVar\r\n\r\n#### Web Interface Queries\r\n\r\nSearch ClinVar using the web interface at https://www.ncbi.nlm.nih.gov/clinvar/\r\n\r\n**Common search patterns:**\r\n- By gene: `BRCA1[gene]`\r\n- By clinical significance: `pathogenic[CLNSIG]`\r\n- By condition: `breast cancer[disorder]`\r\n- By variant: `NM_000059.3:c.1310_1313del[variant name]`\r\n- By chromosome: `13[chr]`\r\n- Combined: `BRCA1[gene] AND pathogenic[CLNSIG]`\r\n\r\n#### Programmatic Access via E-utilities\r\n\r\nAccess ClinVar programmatically using NCBI's E-utilities API. Refer to `references/api_reference.md` for comprehensive API documentation including:\r\n- **esearch** - Search for variants matching criteria\r\n- **esummary** - Retrieve variant summaries\r\n- **efetch** - Download full XML records\r\n- **elink** - Find related records in other NCBI databases\r\n\r\n**Quick example using curl:**\r\n```bash\r\ncurl \"https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=clinvar&term=BRCA1[gene]+AND+pathogenic[CLNSIG]&retmode=json\"\r\n```\r\n\r\n**Best practices:**\r\n- Test queries on the web interface before automating\r\n- Use API keys to increase rate limits from 3 to 10 requests/second\r\n- Implement exponential backoff for rate limit errors\r\n- Set `Entrez.email` when using Biopython\r\n\r\n### 2. Interpret Clinical Significance\r\n\r\n#### Understanding Classifications\r\n\r\nClinVar uses standardized terminology for variant classifications. Refer to `references/clinical_significance.md` for detailed interpretation guidelines.\r\n\r\n**Key germline classification terms (ACMG/AMP):**\r\n- **Pathogenic (P)** - Variant causes disease (~99% probability)\r\n- **Likely Pathogenic (LP)** - Variant likely causes disease (~90% probability)\r\n- **Uncertain Significance (VUS)** - Insufficient evidence to classify\r\n- **Likely Benign (LB)** - Variant likely does not cause disease\r\n- **Benign (B)** - Variant does not cause disease\r\n\r\n**Review status (star ratings):**\r\n- ★★★★ Practice guideline - Highest confidence\r\n- ★★★ Expert panel review (e.g., ClinGen) - High confidence\r\n- ★★ Multiple submitters, no conflicts - Moderate confidence\r\n- ★ Single submitter with criteria - Standard weight\r\n- ☆ No assertion criteria - Low confidence\r\n\r\n**Critical considerations:**\r\n- Always check review status - prefer ★★★ or ★★★★ ratings\r\n- Conflicting interpretations require manual evaluation\r\n- Classifications may change as new evidence emerges\r\n- VUS (uncertain significance) variants lack sufficient evidence for clinical use\r\n\r\n### 3. Download Bulk Data from FTP\r\n\r\n#### Access ClinVar FTP Site\r\n\r\nDownload complete datasets from `ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/`\r\n\r\nRefer to `references/data_formats.md` for comprehensive documentation on file formats and processing.\r\n\r\n**Update schedule:**\r\n- Monthly releases: First Thursday of each month (complete dataset, archived)\r\n- Weekly updates: Every Monday (incremental updates)\r\n\r\n#### Available Formats\r\n\r\n**XML files** (most comprehensive):\r\n- VCV (Variation) files: `xml/clinvar_variation/` - Variant-centric aggregation\r\n- RCV (Record) files: `xml/RCV/` - Variant-condition pairs\r\n- Include full submission details, evidence, and metadata\r\n\r\n**VCF files** (for genomic pipelines):\r\n- GRCh37: `vcf_GRCh37/clinvar.vcf.gz`\r\n- GRCh38: `vcf_GRCh38/clinvar.vcf.gz`\r\n- Limitations: Excludes variants >10kb and complex structural variants\r\n\r\n**Tab-delimited files** (for quick analysis):\r\n- `tab_delimited/variant_summary.txt.gz` - Summary of all variants\r\n- `tab_delimited/var_citations.txt.gz` - PubMed citations\r\n- `tab_delimited/cross_references.txt.gz` - Database cross-references\r\n\r\n**Example download:**\r\n```bash\r\nwget ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/xml/clinvar_variation/ClinVarVariationRelease_00-latest.xml.gz\r\n\r\nwget ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz\r\n```\r\n\r\n### 4. Process and Analyze ClinVar Data\r\n\r\n#### Working with XML Files\r\n\r\nProcess XML files to extract variant details, classifications, and evidence.\r\n\r\n**Python example with xml.etree:**\r\n```python\r\nimport gzip\r\nimport xml.etree.ElementTree as ET\r\n\r\nwith gzip.open('ClinVarVariationRelease.xml.gz', 'rt') as f:\r\n    for event, elem in ET.iterparse(f, events=('end',)):\r\n        if elem.tag == 'VariationArchive':\r\n            variation_id = elem.attrib.get('VariationID')\r\n            # Extract clinical significance, review status, etc.\r\n            elem.clear()  # Free memory\r\n```\r\n\r\n#### Working with VCF Files\r\n\r\nAnnotate variant calls or filter by clinical significance using bcftools or Python.\r\n\r\n**Using bcftools:**\r\n```bash\r\nbcftools view -i 'INFO/CLNSIG~\"Pathogenic\"' clinvar.vcf.gz\r\n\r\nbcftools view -i 'INFO/GENEINFO~\"BRCA\"' clinvar.vcf.gz\r\n\r\nbcftools annotate -a clinvar.vcf.gz -c INFO your_variants.vcf\r\n```\r\n\r\n**Using PyVCF in Python:**\r\n```python\r\nimport vcf\r\n\r\nvcf_reader = vcf.Reader(filename='clinvar.vcf.gz')\r\nfor record in vcf_reader:\r\n    clnsig = record.INFO.get('CLNSIG', [])\r\n    if 'Pathogenic' in clnsig:\r\n        gene = record.INFO.get('GENEINFO', [''])[0]\r\n        print(f\"{record.CHROM}:{record.POS} {gene} - {clnsig}\")\r\n```\r\n\r\n#### Working with Tab-Delimited Files\r\n\r\nUse pandas or command-line tools for rapid filtering and analysis.\r\n\r\n**Using pandas:**\r\n```python\r\nimport pandas as pd\r\n\r\ndf = pd.read_csv('variant_summary.txt.gz', sep='\\t', compression='gzip')\r\n\r\npathogenic_brca = df[\r\n    (df['GeneSymbol'] == 'BRCA1') &\r\n    (df['ClinicalSignificance'].str.contains('Pathogenic', na=False))\r\n]\r\n\r\nsig_counts = df['ClinicalSignificance'].value_counts()\r\n```\r\n\r\n**Using command-line tools:**\r\n```bash",
  "name": "clinvar-database",
  "id": "scientific-db-clinvar-database",
  "sections": {
    "Important Limitations and Considerations": "### Data Quality\r\n- **Not all submissions have equal weight** - Check review status (star ratings)\r\n- **Conflicting interpretations exist** - Require manual evaluation\r\n- **Historical submissions may be outdated** - Newer data may be more accurate\r\n- **VUS classification is not a clinical diagnosis** - Means insufficient evidence\r\n\r\n### Scope Limitations\r\n- **Not for direct clinical diagnosis** - Always involve genetics professional\r\n- **Population-specific** - Variant frequencies vary by ancestry\r\n- **Incomplete coverage** - Not all genes or variants are well-studied\r\n- **Version dependencies** - Coordinate genome build (GRCh37/GRCh38) across analyses\r\n\r\n### Technical Limitations\r\n- **VCF files exclude large variants** - Variants >10kb not in VCF format\r\n- **Rate limits on API** - 3 req/sec without key, 10 req/sec with API key\r\n- **File sizes** - Full XML releases are multi-GB compressed files\r\n- **No real-time updates** - Website updated weekly, FTP monthly/weekly",
    "Overview": "ClinVar is NCBI's freely accessible archive of reports on relationships between human genetic variants and phenotypes, with supporting evidence. The database aggregates information about genomic variation and its relationship to human health, providing standardized variant classifications used in clinical genetics and research.",
    "When to Use This Skill": "This skill should be used when:\r\n\r\n- Searching for variants by gene, condition, or clinical significance\r\n- Interpreting clinical significance classifications (pathogenic, benign, VUS)\r\n- Accessing ClinVar data programmatically via E-utilities API\r\n- Downloading and processing bulk data from FTP\r\n- Understanding review status and star ratings\r\n- Resolving conflicting variant interpretations\r\n- Annotating variant call sets with clinical significance",
    "Workflow Examples": "### Example 1: Identify High-Confidence Pathogenic Variants in a Gene\r\n\r\n**Objective:** Find pathogenic variants in CFTR gene with expert panel review.\r\n\r\n**Steps:**\r\n1. Search using web interface or E-utilities:\r\n   ```\r\n   CFTR[gene] AND pathogenic[CLNSIG] AND (reviewed by expert panel[RVSTAT] OR practice guideline[RVSTAT])\r\n   ```\r\n2. Review results, noting review status (should be ★★★ or ★★★★)\r\n3. Export variant list or retrieve full records via efetch\r\n4. Cross-reference with clinical presentation if applicable\r\n\r\n### Example 2: Annotate VCF with ClinVar Classifications\r\n\r\n**Objective:** Add clinical significance annotations to variant calls.\r\n\r\n**Steps:**\r\n1. Download appropriate ClinVar VCF (match genome build: GRCh37 or GRCh38):\r\n   ```bash\r\n   wget ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz\r\n   wget ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/clinvar.vcf.gz.tbi\r\n   ```\r\n2. Annotate using bcftools:\r\n   ```bash\r\n   bcftools annotate -a clinvar.vcf.gz \\\r\n     -c INFO/CLNSIG,INFO/CLNDN,INFO/CLNREVSTAT \\\r\n     -o annotated_variants.vcf \\\r\n     your_variants.vcf\r\n   ```\r\n3. Filter annotated VCF for pathogenic variants:\r\n   ```bash\r\n   bcftools view -i 'INFO/CLNSIG~\"Pathogenic\"' annotated_variants.vcf\r\n   ```\r\n\r\n### Example 3: Analyze Variants for a Specific Disease\r\n\r\n**Objective:** Study all variants associated with hereditary breast cancer.\r\n\r\n**Steps:**\r\n1. Search by condition:\r\n   ```\r\n   hereditary breast cancer[disorder] OR \"Breast-ovarian cancer, familial\"[disorder]\r\n   ```\r\n2. Download results as CSV or retrieve via E-utilities\r\n3. Filter by review status to prioritize high-confidence variants\r\n4. Analyze distribution across genes (BRCA1, BRCA2, PALB2, etc.)\r\n5. Examine variants with conflicting interpretations separately\r\n\r\n### Example 4: Bulk Download and Database Construction\r\n\r\n**Objective:** Build a local ClinVar database for analysis pipeline.\r\n\r\n**Steps:**\r\n1. Download monthly release for reproducibility:\r\n   ```bash\r\n   wget ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/xml/clinvar_variation/ClinVarVariationRelease_YYYY-MM.xml.gz\r\n   ```\r\n2. Parse XML and load into database (PostgreSQL, MySQL, MongoDB)\r\n3. Index by gene, position, clinical significance, review status\r\n4. Implement version tracking for updates\r\n5. Schedule monthly updates from FTP site",
    "Core Capabilities": "zcat variant_summary.txt.gz | \\\r\n  awk -F'\\t' '$7==\"TP53\" && $13~\"Pathogenic\"' | \\\r\n  cut -f1,5,7,13,14\r\n```\r\n\r\n### 5. Handle Conflicting Interpretations\r\n\r\nWhen multiple submitters provide different classifications for the same variant, ClinVar reports \"Conflicting interpretations of pathogenicity.\"\r\n\r\n**Resolution strategy:**\r\n1. Check review status (star rating) - higher ratings carry more weight\r\n2. Examine evidence and assertion criteria from each submitter\r\n3. Consider submission dates - newer submissions may reflect updated evidence\r\n4. Review population frequency data (e.g., gnomAD) for context\r\n5. Consult expert panel classifications (★★★) when available\r\n6. For clinical use, always defer to a genetics professional\r\n\r\n**Search query to exclude conflicts:**\r\n```\r\nTP53[gene] AND pathogenic[CLNSIG] NOT conflicting[RVSTAT]\r\n```\r\n\r\n### 6. Track Classification Updates\r\n\r\nVariant classifications may change over time as new evidence emerges.\r\n\r\n**Why classifications change:**\r\n- New functional studies or clinical data\r\n- Updated population frequency information\r\n- Revised ACMG/AMP guidelines\r\n- Segregation data from additional families\r\n\r\n**Best practices:**\r\n- Document ClinVar version and access date for reproducibility\r\n- Re-check classifications periodically for critical variants\r\n- Subscribe to ClinVar mailing list for major updates\r\n- Use monthly archived releases for stable datasets\r\n\r\n### 7. Submit Data to ClinVar\r\n\r\nOrganizations can submit variant interpretations to ClinVar.\r\n\r\n**Submission methods:**\r\n- Web submission portal: https://submit.ncbi.nlm.nih.gov/subs/clinvar/\r\n- API submission (requires service account): See `references/api_reference.md`\r\n- Batch submission via Excel templates\r\n\r\n**Requirements:**\r\n- Organizational account with NCBI\r\n- Assertion criteria (preferably ACMG/AMP guidelines)\r\n- Supporting evidence for classification\r\n\r\nContact: clinvar@ncbi.nlm.nih.gov for submission account setup.",
    "Resources": "### Reference Documentation\r\n\r\nThis skill includes comprehensive reference documentation:\r\n\r\n- **`references/api_reference.md`** - Complete E-utilities API documentation with examples for esearch, esummary, efetch, and elink; includes rate limits, authentication, and Python/Biopython code samples\r\n\r\n- **`references/clinical_significance.md`** - Detailed guide to interpreting clinical significance classifications, review status star ratings, conflict resolution, and best practices for variant interpretation\r\n\r\n- **`references/data_formats.md`** - Documentation for XML, VCF, and tab-delimited file formats; FTP directory structure, processing examples, and format selection guidance\r\n\r\n### External Resources\r\n\r\n- ClinVar home: https://www.ncbi.nlm.nih.gov/clinvar/\r\n- ClinVar documentation: https://www.ncbi.nlm.nih.gov/clinvar/docs/\r\n- E-utilities documentation: https://www.ncbi.nlm.nih.gov/books/NBK25501/\r\n- ACMG variant interpretation guidelines: Richards et al., 2015 (PMID: 25741868)\r\n- ClinGen expert panels: https://clinicalgenome.org/\r\n\r\n### Contact\r\n\r\nFor questions about ClinVar or data submission: clinvar@ncbi.nlm.nih.gov"
  }
}
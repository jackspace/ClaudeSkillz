{
  "description": "Infer gene regulatory networks (GRNs) from gene expression data using scalable algorithms (GRNBoost2, GENIE3). Use when analyzing transcriptomics data (bulk RNA-seq, single-cell RNA-seq) to identify transcription factor-target gene relationships and regulatory interactions. Supports distributed computation for large-scale datasets.",
  "references": {
    "files": [
      "references/algorithms.md",
      "references/basic_inference.md",
      "references/distributed_computing.md"
    ]
  },
  "content": "### 1. Basic GRN Inference\r\n\r\nFor standard GRN inference workflows including:\r\n- Input data preparation (Pandas DataFrame or NumPy array)\r\n- Running inference with GRNBoost2 or GENIE3\r\n- Filtering by transcription factors\r\n- Output format and interpretation\r\n\r\n**See**: `references/basic_inference.md`\r\n\r\n**Use the ready-to-run script**: `scripts/basic_grn_inference.py` for standard inference tasks:\r\n```bash\r\npython scripts/basic_grn_inference.py expression_data.tsv output_network.tsv --tf-file tfs.txt --seed 777\r\n```\r\n\r\n### 2. Algorithm Selection\r\n\r\nArboreto provides two algorithms:\r\n\r\n**GRNBoost2 (Recommended)**:\r\n- Fast gradient boosting-based inference\r\n- Optimized for large datasets (10k+ observations)\r\n- Default choice for most analyses\r\n\r\n**GENIE3**:\r\n- Random Forest-based inference\r\n- Original multiple regression approach\r\n- Use for comparison or validation\r\n\r\nQuick comparison:\r\n```python\r\nfrom arboreto.algo import grnboost2, genie3\r\n\r\nnetwork_grnboost = grnboost2(expression_data=matrix)\r\n\r\n\r\nArboreto is a core component of the SCENIC pipeline for single-cell regulatory network analysis:\r\n\r\n```python\r\nfrom arboreto.algo import grnboost2\r\nnetwork = grnboost2(expression_data=sc_data, tf_names=tf_list)",
  "name": "arboreto",
  "id": "scientific-pkg-arboreto",
  "sections": {
    "Quick Start": "Install arboreto:\r\n```bash\r\npip install arboreto\r\n```\r\n\r\nBasic GRN inference:\r\n```python\r\nimport pandas as pd\r\nfrom arboreto.algo import grnboost2\r\n\r\nif __name__ == '__main__':\r\n    # Load expression data (genes as columns)\r\n    expression_matrix = pd.read_csv('expression_data.tsv', sep='\\t')\r\n\r\n    # Infer regulatory network\r\n    network = grnboost2(expression_data=expression_matrix)\r\n\r\n    # Save results (TF, target, importance)\r\n    network.to_csv('network.tsv', sep='\\t', index=False, header=False)\r\n```\r\n\r\n**Critical**: Always use `if __name__ == '__main__':` guard because Dask spawns new processes.",
    "Installation": "**Recommended (Conda)**:\r\n```bash\r\nconda install -c bioconda arboreto\r\n```\r\n\r\n**Alternative (pip)**:\r\n```bash\r\npip install arboreto\r\n```\r\n\r\n**For isolated environment**:\r\n```bash\r\nconda create --name arboreto-env\r\nconda activate arboreto-env\r\nconda install -c bioconda arboreto\r\n```\r\n\r\n**Dependencies**: scipy, scikit-learn, numpy, pandas, dask, distributed",
    "Troubleshooting": "**Memory errors**: Reduce dataset size by filtering low-variance genes or use distributed computing\r\n\r\n**Slow performance**: Use GRNBoost2 instead of GENIE3, enable distributed client, filter TF list\r\n\r\n**Dask errors**: Ensure `if __name__ == '__main__':` guard is present in scripts\r\n\r\n**Empty results**: Check data format (genes as columns), verify TF names match gene names",
    "Overview": "Arboreto is a computational library for inferring gene regulatory networks (GRNs) from gene expression data using parallelized algorithms that scale from single machines to multi-node clusters.\r\n\r\n**Core capability**: Identify which transcription factors (TFs) regulate which target genes based on expression patterns across observations (cells, samples, conditions).",
    "Output Interpretation": "Arboreto returns a DataFrame with regulatory links:\r\n\r\n| Column | Description |\r\n|--------|-------------|\r\n| `TF` | Transcription factor (regulator) |\r\n| `target` | Target gene |\r\n| `importance` | Regulatory importance score (higher = stronger) |\r\n\r\n**Filtering strategy**:\r\n- Top N links per target gene\r\n- Importance threshold (e.g., > 0.5)\r\n- Statistical significance testing (permutation tests)",
    "Reproducibility": "Always set a seed for reproducible results:\r\n```python\r\nnetwork = grnboost2(expression_data=matrix, seed=777)\r\n```\r\n\r\nRun multiple seeds for robustness analysis:\r\n```python\r\nfrom distributed import LocalCluster, Client\r\n\r\nif __name__ == '__main__':\r\n    client = Client(LocalCluster())\r\n\r\n    seeds = [42, 123, 777]\r\n    networks = []\r\n\r\n    for seed in seeds:\r\n        net = grnboost2(expression_data=matrix, client_or_address=client, seed=seed)\r\n        networks.append(net)\r\n\r\n    # Combine networks and filter consensus links\r\n    consensus = analyze_consensus(networks)\r\n```",
    "Common Use Cases": "### Single-Cell RNA-seq Analysis\r\n```python\r\nimport pandas as pd\r\nfrom arboreto.algo import grnboost2\r\n\r\nif __name__ == '__main__':\r\n    # Load single-cell expression matrix (cells x genes)\r\n    sc_data = pd.read_csv('scrna_counts.tsv', sep='\\t')\r\n\r\n    # Infer cell-type-specific regulatory network\r\n    network = grnboost2(expression_data=sc_data, seed=42)\r\n\r\n    # Filter high-confidence links\r\n    high_confidence = network[network['importance'] > 0.5]\r\n    high_confidence.to_csv('grn_high_confidence.tsv', sep='\\t', index=False)\r\n```\r\n\r\n### Bulk RNA-seq with TF Filtering\r\n```python\r\nfrom arboreto.utils import load_tf_names\r\nfrom arboreto.algo import grnboost2\r\n\r\nif __name__ == '__main__':\r\n    # Load data\r\n    expression_data = pd.read_csv('rnaseq_tpm.tsv', sep='\\t')\r\n    tf_names = load_tf_names('human_tfs.txt')\r\n\r\n    # Infer with TF restriction\r\n    network = grnboost2(\r\n        expression_data=expression_data,\r\n        tf_names=tf_names,\r\n        seed=123\r\n    )\r\n\r\n    network.to_csv('tf_target_network.tsv', sep='\\t', index=False)\r\n```\r\n\r\n### Comparative Analysis (Multiple Conditions)\r\n```python\r\nfrom arboreto.algo import grnboost2\r\n\r\nif __name__ == '__main__':\r\n    # Infer networks for different conditions\r\n    conditions = ['control', 'treatment_24h', 'treatment_48h']\r\n\r\n    for condition in conditions:\r\n        data = pd.read_csv(f'{condition}_expression.tsv', sep='\\t')\r\n        network = grnboost2(expression_data=data, seed=42)\r\n        network.to_csv(f'{condition}_network.tsv', sep='\\t', index=False)\r\n```",
    "Core Capabilities": "network_genie3 = genie3(expression_data=matrix)\r\n```\r\n\r\n**For detailed algorithm comparison, parameters, and selection guidance**: `references/algorithms.md`\r\n\r\n### 3. Distributed Computing\r\n\r\nScale inference from local multi-core to cluster environments:\r\n\r\n**Local (default)** - Uses all available cores automatically:\r\n```python\r\nnetwork = grnboost2(expression_data=matrix)\r\n```\r\n\r\n**Custom local client** - Control resources:\r\n```python\r\nfrom distributed import LocalCluster, Client\r\n\r\nlocal_cluster = LocalCluster(n_workers=10, memory_limit='8GB')\r\nclient = Client(local_cluster)\r\n\r\nnetwork = grnboost2(expression_data=matrix, client_or_address=client)\r\n\r\nclient.close()\r\nlocal_cluster.close()\r\n```\r\n\r\n**Cluster computing** - Connect to remote Dask scheduler:\r\n```python\r\nfrom distributed import Client\r\n\r\nclient = Client('tcp://scheduler:8786')\r\nnetwork = grnboost2(expression_data=matrix, client_or_address=client)\r\n```\r\n\r\n**For cluster setup, performance optimization, and large-scale workflows**: `references/distributed_computing.md`",
    "Integration with pySCENIC": "```"
  }
}
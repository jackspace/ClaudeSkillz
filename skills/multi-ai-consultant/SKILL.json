{
  "description": "|",
  "metadata": {
    "allowedTools": "[Bash, Read, Task, Write]",
    "license": "MIT"
  },
  "references": {
    "files": [
      "references/ai-strengths.md"
    ]
  },
  "content": "Consult external AIs for second opinions when Claude Code is stuck or making critical decisions.\r\n\r\n---\r\n\r\n\r\n### 1. Install CLIs\r\n\r\n**Gemini CLI** (required):\r\n```bash\r\nnpm install -g @google/generative-ai-cli\r\nexport GEMINI_API_KEY=\"your-key\"\r\n```\r\n\r\nGet API key: https://aistudio.google.com/apikey\r\n\r\n**Codex CLI** (optional):\r\n```bash\r\nnpm install -g codex\r\nexport OPENAI_API_KEY=\"sk-...\"\r\n```\r\n\r\nGet API key: https://platform.openai.com/api-keys\r\n\r\n**Fresh Claude**: Built-in (uses Task tool, no setup)\r\n\r\n### 2. Install Skill\r\n\r\n```bash\r\ncd ~/.claude/skills\r\ngit clone [this-repo] multi-ai-consultant\r\n```\r\n\r\n### 3. Copy Templates to Project\r\n\r\n```bash\r\ncp ~/.claude/skills/multi-ai-consultant/templates/GEMINI.md ./\r\ncp ~/.claude/skills/multi-ai-consultant/templates/codex.md ./\r\ncp ~/.claude/skills/multi-ai-consultant/templates/.geminiignore ./\r\n\r\ncp ~/.claude/skills/multi-ai-consultant/templates/consultation-log-parser.sh ~/bin/\r\nchmod +x ~/bin/consultation-log-parser.sh\r\n```\r\n\r\n### 4. Verify Installation\r\n\r\n```bash\r\ngemini -p \"test\" && echo \"‚úÖ Gemini working\"\r\n\r\ncodex exec \"test\" --yolo && echo \"‚úÖ Codex working\"\r\n\r\n\r\nEvery consultation is logged to `~/.claude/ai-consultations/consultations.log`\r\n\r\n**Format**:\r\n```csv\r\n2025-11-07T14:23:45-05:00,gemini,gemini-2.5-pro,15420,850,0.1834,/home/user/project\r\n2025-11-07T15:10:22-05:00,codex,gpt-4-turbo,8230,430,0.0952,/home/user/project\r\n2025-11-07T16:05:11-05:00,claude-subagent,claude-sonnet-4-5,0,0,0.00,/home/user/project\r\n```\r\n\r\n**View logs**:\r\n```bash\r\nconsultation-log-parser.sh --summary\r\n\r\n### Automatic Protection\r\n\r\nBoth CLIs respect `.gitignore` automatically. Files in `.gitignore` are never sent.\r\n\r\n### Additional Protection (`.geminiignore`)\r\n\r\nCreate `.geminiignore` in project root for extra exclusions:\r\n```gitignore\r\n*.env*\r\n*secret*\r\n*credentials*\r\n.dev.vars\r\nwrangler.toml\r\n```\r\n\r\n### Pre-Consultation Check\r\n\r\nClaude Code should warn if:\r\n- Sensitive file patterns detected in context\r\n- Not in Git repo (Codex)\r\n- Large context (>100k tokens estimated)\r\n\r\n**Ask permission**: \"About to send context to [AI]. Files include: [list]. Proceed?\"\r\n\r\n### Manual Verification\r\n\r\nBefore consultation, user can check:\r\n```bash\r\nls -la @src/\r\n\r\n\r\n### 1. CLI Not Installed\r\n\r\n**Error**: `gemini: command not found` or `codex: command not found`\r\n\r\n**Fix**:\r\n```bash\r\nnpm install -g @google/generative-ai-cli\r\nnpm install -g codex\r\n```\r\n\r\n**Prevention**: Pre-flight checks in slash commands\r\n\r\n---\r\n\r\n### 2. API Keys Invalid\r\n\r\n**Error**: \"API key invalid\" or authentication failures\r\n\r\n**Fix**:\r\n```bash\r\nexport GEMINI_API_KEY=\"your-key\"\r\nexport OPENAI_API_KEY=\"sk-...\"\r\n\r\n\r\n### Gemini Not Working\r\n\r\n```bash\r\nwhich gemini\r\n\r\necho $GEMINI_API_KEY\r\n\r\ngemini -p \"test\"\r\n\r\ncurl -H \"Content-Type: application/json\" \\\r\n  -d '{\"contents\":[{\"parts\":[{\"text\":\"test\"}]}]}' \\\r\n  \"https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=$GEMINI_API_KEY\"\r\n```\r\n\r\n### Codex Not Working\r\n\r\n```bash\r\nwhich codex\r\n\r\necho $OPENAI_API_KEY\r\n\r\necho \"test\" | codex exec - --yolo\r\n\r\nopenai api models.list\r\n```\r\n\r\n### Fresh Claude Not Working\r\n\r\n```bash\r\nclaude --version\r\n```\r\n\r\n### Skill Not Discovered\r\n\r\n```bash\r\nls -la ~/.claude/skills/multi-ai-consultant\r\n\r\nhead -20 ~/.claude/skills/multi-ai-consultant/SKILL.md",
  "name": "Multi-AI Consultant",
  "id": "multi-ai-consultant",
  "sections": {
    "Slash Commands": "### `/consult-gemini [question]`\r\n\r\n**Use when**: Need web research, latest docs, extended thinking\r\n\r\n**What it does**:\r\n1. Pre-flight check (Gemini CLI working?)\r\n2. Smart context selection based on problem type\r\n3. Execute with locked config: `gemini-2.5-pro --thinking --google-search --grounding`\r\n4. Parse JSON response\r\n5. Synthesize with 5-part format\r\n6. Log cost to `~/.claude/ai-consultations/consultations.log`\r\n\r\n**Example**:\r\n```\r\n/consult-gemini Is this JWT validation secure by 2025 standards?\r\n```\r\n\r\n**Context**: Uses `@<path>` syntax for selective context\r\n\r\n**System instructions**: Auto-loads `GEMINI.md` from project root\r\n\r\n**Privacy**: Respects `.gitignore` + `.geminiignore`\r\n\r\n---\r\n\r\n### `/consult-codex [question]`\r\n\r\n**Use when**: Need repo-aware analysis, code review, OpenAI reasoning\r\n\r\n**What it does**:\r\n1. Pre-flight check (OpenAI API key valid?)\r\n2. `cd` to project directory (Codex scans automatically)\r\n3. Execute with `--yolo` flag: `codex exec - -m gpt-4-turbo --yolo`\r\n4. Parse output from temp file\r\n5. Synthesize with 5-part format\r\n6. Log cost (estimated tokens)\r\n\r\n**Example**:\r\n```\r\n/consult-codex Review this codebase for performance issues\r\n```\r\n\r\n**Context**: Repo-aware (automatically reads all non-gitignored files)\r\n\r\n**System instructions**: Auto-loads `codex.md` from project root or `~/.codex/instructions.md`\r\n\r\n**Privacy**: Respects `.gitignore`, warns if not in Git repo\r\n\r\n---\r\n\r\n### `/consult-claude [question]`\r\n\r\n**Use when**: Quick second opinion, free, fresh perspective\r\n\r\n**What it does**:\r\n1. Gather context with Read tool\r\n2. Build detailed prompt for subagent\r\n3. Launch Task tool (general-purpose subagent)\r\n4. Receive fresh perspective\r\n5. Synthesize with 5-part format\r\n6. Log consultation (free, but tracked)\r\n\r\n**Example**:\r\n```\r\n/consult-claude Am I missing something obvious in this state management bug?\r\n```\r\n\r\n**Context**: You manually read relevant files and pass inline\r\n\r\n**Advantages**: Free, same capabilities, fast, fresh perspective\r\n\r\n**Limitations**: No web search, no extended thinking, same knowledge cutoff\r\n\r\n---\r\n\r\n### `/consult-ai [question]`\r\n\r\n**Use when**: Unsure which AI to use\r\n\r\n**What it does**:\r\n1. Analyze problem type (bug, architecture, security, etc.)\r\n2. Recommend which AI based on needs\r\n3. Ask user to choose\r\n4. Route to appropriate command\r\n\r\n**Example**:\r\n```\r\n/consult-ai How should we structure this microservices architecture?\r\n\r\n‚Üí Recommends Gemini (needs web research for latest patterns)\r\n‚Üí User approves\r\n‚Üí Executes /consult-gemini internally\r\n```\r\n\r\n**Decision factors**:\r\n- Need web research? ‚Üí Gemini\r\n- Need repo-aware? ‚Üí Codex\r\n- Need budget-friendly? ‚Üí Fresh Claude\r\n- Need extended thinking? ‚Üí Gemini\r\n- Need fresh perspective? ‚Üí Fresh Claude\r\n\r\n---",
    "How It Works": "### Architecture\r\n\r\n```\r\nClaude Code encounters bug/decision\r\n        ‚Üì\r\nSuggests consultation (or user requests)\r\n        ‚Üì\r\nUser approves\r\n        ‚Üì\r\nExecute appropriate slash command\r\n        ‚Üì\r\nCLI command calls external AI\r\n        ‚Üì\r\nParse response\r\n        ‚Üì\r\nSynthesize: Claude's analysis + External AI's analysis\r\n        ‚Üì\r\nPresent 5-part comparison\r\n        ‚Üì\r\nAsk permission to implement\r\n```\r\n\r\n### The 5-Part Synthesis Format\r\n\r\nEvery consultation must follow this format (prevents parroting):\r\n\r\n1. **ü§ñ My Analysis** - Claude's original reasoning and attempts\r\n2. **üíé/üî∑/üîÑ Other AI's Analysis** - External AI's complete response\r\n3. **üîç Key Differences** - Agreement, divergence, what each AI caught/missed\r\n4. **‚ö° Synthesis** - Combined perspective, root cause, trade-offs\r\n5. **‚úÖ Recommended Action** - Specific next steps with file paths/line numbers\r\n\r\n**End with**: \"Should I proceed with this approach?\"\r\n\r\n---",
    "Why CLI Approach (Not MCP)?": "| Aspect | MCP Server | CLI Approach |\r\n|--------|------------|--------------|\r\n| Setup time | 4-6 hours | 60-75 minutes |\r\n| Complexity | High (MCP protocol) | Low (bash + CLIs) |\r\n| Maintenance | Update MCP SDK | Update CLI (rare) |\r\n| Flexibility | Locked to AIs | Any AI with CLI |\r\n| Debugging | MCP protocol | Standard bash |\r\n| Dependencies | MCP SDK, npm | Just CLIs |\r\n\r\n**Winner**: CLI approach - 80% less effort, same functionality\r\n\r\n---",
    "Success Metrics": "### Time Efficiency\r\n- **Without skill**: 30-45 minutes (trial and error)\r\n- **With skill**: 5-10 minutes (consultation + fix)\r\n- **Savings**: ~75%\r\n\r\n### Token Efficiency\r\n- **Without skill**: ~20k tokens (multiple attempts)\r\n- **With skill**: ~8k tokens (one consultation)\r\n- **Savings**: ~60%\r\n\r\n### Error Prevention\r\n- **Manual CLI use**: 3-5 common errors (flags, parsing, privacy)\r\n- **With skill**: 0 errors (all handled by commands)\r\n- **Prevention**: 100%\r\n\r\n### Quality\r\n- **Manual**: Risk of not synthesizing (just copying external AI)\r\n- **With skill**: Forced synthesis via `GEMINI.md`/`codex.md`\r\n- **Improvement**: Guaranteed value-add\r\n\r\n---",
    "References": "### External Resources\r\n\r\n- **Gemini CLI**: https://ai.google.dev/gemini-api/docs/cli\r\n- **OpenAI Codex**: https://www.npmjs.com/package/codex\r\n- **OpenAI API**: https://platform.openai.com/docs\r\n- **Gemini API Pricing**: https://ai.google.dev/pricing\r\n- **OpenAI Pricing**: https://openai.com/pricing\r\n\r\n### Internal Files\r\n\r\n- **Planning docs**: `planning/multi-ai-consultant-*.md`\r\n- **Slash commands**: `commands/*.md`\r\n- **Templates**: `templates/*`\r\n- **Scripts**: `scripts/*`\r\n\r\n---",
    "The Three AIs": "| AI | Tool | When to Use | Special Features | Cost |\r\n|----|------|-------------|------------------|------|\r\n| **Gemini 2.5 Pro** | `gemini` CLI | Web research, latest docs, thinking | Google Search, extended reasoning, grounding | ~$0.10-0.50 |\r\n| **OpenAI GPT-4** | `codex` CLI | Repo-aware analysis, code review | Auto-scans directory, OpenAI reasoning | ~$0.05-0.30 |\r\n| **Fresh Claude** | Task tool | Quick second opinion, budget-friendly | Same capabilities, fresh perspective | Free |\r\n\r\n---",
    "Templates": "### `GEMINI.md` (Project Root)\r\n\r\nSystem instructions for Gemini consultations. Enforces:\r\n- 5-part response format\r\n- Comparison with Claude's analysis\r\n- Web search for latest docs\r\n- Specific code references\r\n- No parroting\r\n\r\n**Auto-loaded**: Place in project root, Gemini CLI reads automatically\r\n\r\n### `codex.md` (Project Root or `~/.codex/instructions.md`)\r\n\r\nSystem instructions for Codex consultations. Enforces:\r\n- 5-part response format\r\n- Repo-aware analysis\r\n- Consistency checks\r\n- Impact assessment\r\n- Specific file references\r\n\r\n**Auto-loaded**: Codex CLI reads from project root or global config\r\n\r\n### `.geminiignore` (Project Root)\r\n\r\nExtra privacy exclusions beyond `.gitignore`. Excludes:\r\n- `.env*` files\r\n- `*secret*`, `*credentials*`\r\n- Build artifacts\r\n- Large media files\r\n- API keys and tokens\r\n\r\n**Auto-loaded**: Gemini CLI respects this file\r\n\r\n### `consultation-log-parser.sh`\r\n\r\nView consultation history:\r\n```bash\r\nconsultation-log-parser.sh           # Last 10\r\nconsultation-log-parser.sh --all     # All consultations\r\nconsultation-log-parser.sh --summary # Stats only\r\nconsultation-log-parser.sh --ai gemini # Filter by AI\r\n```\r\n\r\n**Log format**: `timestamp,ai,model,input_tokens,output_tokens,cost,project_path`\r\n\r\n---",
    "What This Skill Does": "This skill enables **future Claude Code sessions** to consult other AIs when:\r\n- Stuck on a bug after one failed attempt\r\n- Making architectural decisions\r\n- Security concerns need validation\r\n- Fresh perspective needed\r\n\r\n**Key innovation**: Uses existing CLI tools (`gemini`, `codex`) instead of building MCP servers - much simpler and more maintainable.\r\n\r\n---",
    "When to Use This Skill": "### Automatic Triggers (No User Action Needed)\r\n\r\nClaude Code should **automatically suggest** using this skill when:\r\n\r\n1. **After 1 failed debugging attempt**\r\n   - Tried one approach to fix a bug\r\n   - Still not working or different error\r\n   - ‚Üí Suggest: \"Should I consult [Gemini|Fresh Claude] for a second opinion?\"\r\n\r\n2. **Before architectural decisions**\r\n   - Significant design choices (state management, routing, data flow)\r\n   - Framework selection\r\n   - Database schema design\r\n   - ‚Üí Auto-consult (mention to user): \"Consulting Gemini for architectural validation...\"\r\n\r\n3. **Security changes**\r\n   - Authentication logic\r\n   - Authorization rules\r\n   - Cryptography\r\n   - Input validation\r\n   - ‚Üí Auto-consult: \"Consulting Gemini to verify security approach...\"\r\n\r\n4. **When uncertain**\r\n   - Multiple valid approaches\r\n   - Trade-offs not clear\r\n   - Conflicting advice in documentation\r\n   - ‚Üí Suggest: \"Would you like me to consult another AI for additional perspective?\"\r\n\r\n### Manual Invocation (User Commands)\r\n\r\nUser can explicitly request consultation with:\r\n- `/consult-gemini [question]` - Gemini 2.5 Pro with thinking, search, grounding\r\n- `/consult-codex [question]` - OpenAI GPT-4 via Codex CLI (repo-aware)\r\n- `/consult-claude [question]` - Fresh Claude subagent (free, fast)\r\n- `/consult-ai [question]` - Router that asks which AI to use\r\n\r\n---",
    "Cost Tracking": "```\r\n\r\n**Pricing** (verify current rates):\r\n- Gemini 2.5 Pro: ~$0.000015/input token, ~$0.00006/output token\r\n- GPT-4 Turbo: ~$0.00001/input token, ~$0.00003/output token\r\n- Fresh Claude: Free (same API call)\r\n\r\n---",
    "Troubleshooting": "```\r\n\r\n---",
    "License": "MIT License - See LICENSE file\r\n\r\n---\r\n\r\n**Last Updated**: 2025-11-07\r\n**Status**: Production Ready\r\n**Maintainer**: Jeremy Dawes | jeremy@jezweb.net | https://jezweb.com.au",
    "Token Efficiency": "### Without This Skill\r\n\r\n**Typical scenario** (stuck on bug):\r\n1. Try approach 1 (~4k tokens)\r\n2. Research CLI syntax (~3k tokens)\r\n3. Format response (~2k tokens)\r\n4. Try approach 2 (~4k tokens)\r\n5. Research documentation (~3k tokens)\r\n6. Try approach 3 (~4k tokens)\r\n\r\n**Total**: ~20k tokens, 30-45 minutes\r\n\r\n### With This Skill\r\n\r\n**Same scenario**:\r\n1. Try approach 1 (~4k tokens)\r\n2. Execute `/consult-gemini` (~1k tokens to execute)\r\n3. Gemini finds issue (billed separately, but <5k tokens)\r\n4. Implement fix (~3k tokens)\r\n\r\n**Total**: ~8k tokens, 5-10 minutes\r\n\r\n**Savings**: ~60% tokens, ~75% time\r\n\r\n**Value**: Gemini's web search finds issue Claude couldn't\r\n\r\n---",
    "Privacy & Security": "git status --ignored\r\n```\r\n\r\n---",
    "Contributing": "**Found an issue?**\r\n- Document it in Known Issues section\r\n- Include fix/workaround\r\n- Update slash commands to prevent\r\n\r\n**Adding new AI?**\r\n- Create new slash command: `commands/consult-newai.md`\r\n- Add to router: Update `commands/consult-ai.md`\r\n- Create template: `templates/newai.md` (if CLI supports system instructions)\r\n- Update documentation\r\n\r\n**Improving synthesis?**\r\n- Edit templates: `templates/GEMINI.md`, `templates/codex.md`\r\n- Test with real consultations\r\n- Measure before/after quality\r\n\r\n---",
    "Known Issues & Solutions": "echo 'export GEMINI_API_KEY=\"your-key\"' >> ~/.bashrc\r\nsource ~/.bashrc\r\n```\r\n\r\n**Prevention**: Pre-flight checks test API before consultation\r\n\r\n---\r\n\r\n### 3. Context Too Large\r\n\r\n**Error**: Token limit exceeded or very expensive consultation\r\n\r\n**Fix**: Use smart context selection\r\n- Bug: Just buggy file + imports (not entire codebase)\r\n- Architecture: Relevant directories only\r\n- Use `@path/to/specific/file.ts` not `@.`\r\n\r\n**Prevention**: Slash commands guide smart context selection\r\n\r\n---\r\n\r\n### 4. Privacy Leaks\r\n\r\n**Risk**: Accidentally sending `.env` or secrets\r\n\r\n**Fix**:\r\n- Both CLIs respect `.gitignore` (automatic)\r\n- Create `.geminiignore` for extra protection\r\n- Claude warns if sensitive patterns detected\r\n\r\n**Prevention**: Always check `.gitignore` is configured\r\n\r\n---\r\n\r\n### 5. Cost Overruns\r\n\r\n**Issue**: Expensive consultations accumulating\r\n\r\n**Fix**:\r\n- Check logs: `consultation-log-parser.sh --summary`\r\n- Use Fresh Claude for quick questions (free)\r\n- Use smart context (specific files, not entire repo)\r\n\r\n**Prevention**: Cost tracking + warnings for large context\r\n\r\n---\r\n\r\n### 6. Codex Hanging\r\n\r\n**Error**: `codex exec` hangs waiting for approval\r\n\r\n**Fix**: Always use `--yolo` flag\r\n\r\n**Prevention**: Slash command includes `--yolo` by default (hard to miss)\r\n\r\n---\r\n\r\n### 7. JSON Parsing Fails (Gemini)\r\n\r\n**Error**: `jq: parse error`\r\n\r\n**Fix**: Check exit code before parsing, fall back to plain text\r\n\r\n**Prevention**: Slash command checks exit code first\r\n\r\n---\r\n\r\n### 8. Not in Git Repo (Codex)\r\n\r\n**Warning**: Codex warns if not in Git repo (safety feature)\r\n\r\n**Fix**: Add `--skip-git-repo-check` flag if appropriate\r\n\r\n**Prevention**: Slash command includes flag\r\n\r\n---",
    "Usage Examples": "### Example 1: Stuck on Bug\r\n\r\n**Scenario**: JWT authentication failing after one attempt\r\n\r\n**Claude's process**:\r\n```\r\n1. Try initial fix (token expiry check)\r\n2. Still failing (now \"invalid signature\" error)\r\n3. ‚Üí Automatically suggest consultation\r\n4. User approves\r\n5. Execute /consult-gemini with:\r\n   - Problem: 401 error details\r\n   - What was tried: token expiry fix\r\n   - Current status: invalid signature error\r\n   - Context: @src/auth/session.ts @src/middleware/jwt.ts\r\n6. Gemini finds: Using process.env instead of env binding (Cloudflare)\r\n7. Synthesize both perspectives\r\n8. Ask permission to implement Gemini's fix\r\n```\r\n\r\n**Result**: Bug fixed with second opinion, avoided 2-3 more trial-and-error attempts\r\n\r\n### Example 2: Architecture Decision\r\n\r\n**Scenario**: Choosing state management for new feature\r\n\r\n**Claude's process**:\r\n```\r\n1. User asks: \"How should we handle state for this feature?\"\r\n2. ‚Üí Auto-consult Gemini (architectural decision)\r\n3. Execute /consult-gemini with:\r\n   - Problem: State management choice\r\n   - Options considered: Redux, Zustand, Context\r\n   - Context: @src/ (existing patterns)\r\n4. Gemini searches for latest React state management best practices\r\n5. Synthesize Claude's + Gemini's analysis\r\n6. Present recommendation with trade-offs\r\n```\r\n\r\n**Result**: Informed decision with latest best practices\r\n\r\n### Example 3: Manual Consultation\r\n\r\n**User**: \"I want a second opinion on this refactoring\"\r\n\r\n**Claude's process**:\r\n```\r\n1. User explicitly requests consultation\r\n2. Ask which AI: Gemini, Codex, or Fresh Claude?\r\n3. User chooses Codex (wants repo-aware analysis)\r\n4. Execute /consult-codex with:\r\n   - Problem: Refactoring proposal\r\n   - Context: (Codex scans repo automatically)\r\n5. Codex checks consistency with existing code\r\n6. Synthesize both perspectives\r\n7. Present recommendation\r\n```\r\n\r\n**Result**: Validation of refactoring approach + consistency check\r\n\r\n---",
    "Setup Instructions": "```\r\n\r\n---"
  }
}
{
  "description": "This skill should be used when working with single-cell omics data analysis using scvi-tools, including scRNA-seq, scATAC-seq, CITE-seq, spatial transcriptomics, and other single-cell modalities. Use this skill for probabilistic modeling, batch correction, dimensionality reduction, differential expression, cell type annotation, multimodal integration, and spatial analysis tasks.",
  "references": {
    "files": [
      "references/differential-expression.md",
      "references/models-atac-seq.md",
      "references/models-multimodal.md",
      "references/models-scrna-seq.md",
      "references/models-spatial.md",
      "references/models-specialized.md",
      "references/theoretical-foundations.md",
      "references/workflows.md"
    ]
  },
  "content": "All scvi-tools models follow a consistent API pattern:\r\n\r\n```python\r\nimport scvi\r\nimport scanpy as sc\r\n\r\nadata = scvi.data.heart_cell_atlas_subsampled()\r\nsc.pp.filter_genes(adata, min_counts=3)\r\nsc.pp.highly_variable_genes(adata, n_top_genes=1200)\r\n\r\nscvi.model.SCVI.setup_anndata(\r\n    adata,\r\n    layer=\"counts\",  # Use raw counts, not log-normalized\r\n    batch_key=\"batch\",\r\n    categorical_covariate_keys=[\"donor\"],\r\n    continuous_covariate_keys=[\"percent_mito\"]\r\n)\r\n\r\nmodel = scvi.model.SCVI(adata)\r\nmodel.train()\r\n\r\nlatent = model.get_latent_representation()\r\nnormalized = model.get_normalized_expression(library_size=1e4)\r\n\r\nadata.obsm[\"X_scVI\"] = latent\r\nadata.layers[\"scvi_normalized\"] = normalized\r\n\r\n\r\n### Differential Expression\r\nProbabilistic DE analysis using the learned generative models:\r\n\r\n```python\r\nde_results = model.differential_expression(\r\n    groupby=\"cell_type\",\r\n    group1=\"TypeA\",\r\n    group2=\"TypeB\",\r\n    mode=\"change\",  # Use composite hypothesis testing\r\n    delta=0.25      # Minimum effect size threshold\r\n)\r\n```\r\n\r\nSee `references/differential-expression.md` for detailed methodology and interpretation.\r\n\r\n### Model Persistence\r\nSave and load trained models:\r\n\r\n```python\r\nmodel.save(\"./model_directory\", overwrite=True)\r\n\r\nmodel = scvi.model.SCVI.load(\"./model_directory\", adata=adata)\r\n```\r\n\r\n### Batch Correction and Integration\r\nIntegrate datasets across batches or studies:\r\n\r\n```python\r\nscvi.model.SCVI.setup_anndata(adata, batch_key=\"study\")\r\n\r\n\r\n```bash\r\npip install scvi-tools",
  "name": "scvi-tools",
  "id": "scientific-pkg-scvi-tools",
  "sections": {
    "Common Analysis Tasks": "model = scvi.model.SCVI(adata)\r\nmodel.train()\r\nlatent = model.get_latent_representation()  # Batch-corrected\r\n```",
    "Best Practices": "1. **Use raw counts**: Always provide unnormalized count data to models\r\n2. **Filter genes**: Remove low-count genes before analysis (e.g., `min_counts=3`)\r\n3. **Register covariates**: Include known technical factors (batch, donor, etc.) in `setup_anndata`\r\n4. **Feature selection**: Use highly variable genes for improved performance\r\n5. **Model saving**: Always save trained models to avoid retraining\r\n6. **GPU usage**: Enable GPU acceleration for large datasets (`accelerator=\"gpu\"`)\r\n7. **Scanpy integration**: Store outputs in AnnData objects for downstream analysis",
    "Additional Resources": "- **Workflows**: `references/workflows.md` contains common workflows, best practices, hyperparameter tuning, and GPU optimization\r\n- **Model References**: Detailed documentation for each model category in the `references/` directory\r\n- **Official Documentation**: https://docs.scvi-tools.org/en/stable/\r\n- **Tutorials**: https://docs.scvi-tools.org/en/stable/tutorials/index.html\r\n- **API Reference**: https://docs.scvi-tools.org/en/stable/api/index.html",
    "Installation": "pip install scvi-tools[cuda]\r\n```",
    "Overview": "scvi-tools is a comprehensive Python framework for probabilistic models in single-cell genomics. Built on PyTorch and PyTorch Lightning, it provides deep generative models using variational inference for analyzing diverse single-cell data modalities.",
    "Theoretical Foundations": "scvi-tools is built on:\r\n- **Variational inference**: Approximate posterior distributions for scalable Bayesian inference\r\n- **Deep generative models**: VAE architectures that learn complex data distributions\r\n- **Amortized inference**: Shared neural networks for efficient learning across cells\r\n- **Probabilistic modeling**: Principled uncertainty quantification and statistical testing\r\n\r\nSee `references/theoretical-foundations.md` for detailed background on the mathematical framework.",
    "When to Use This Skill": "Use this skill when:\r\n- Analyzing single-cell RNA-seq data (dimensionality reduction, batch correction, integration)\r\n- Working with single-cell ATAC-seq or chromatin accessibility data\r\n- Integrating multimodal data (CITE-seq, multiome, paired/unpaired datasets)\r\n- Analyzing spatial transcriptomics data (deconvolution, spatial mapping)\r\n- Performing differential expression analysis on single-cell data\r\n- Conducting cell type annotation or transfer learning tasks\r\n- Working with specialized single-cell modalities (methylation, cytometry, RNA velocity)\r\n- Building custom probabilistic models for single-cell analysis",
    "Typical Workflow": "sc.pp.neighbors(adata, use_rep=\"X_scVI\")\r\nsc.tl.umap(adata)\r\nsc.tl.leiden(adata)\r\n```\r\n\r\n**Key Design Principles:**\r\n- **Raw counts required**: Models expect unnormalized count data for optimal performance\r\n- **Unified API**: Consistent interface across all models (setup → train → extract)\r\n- **AnnData-centric**: Seamless integration with the scanpy ecosystem\r\n- **GPU acceleration**: Automatic utilization of available GPUs\r\n- **Batch correction**: Handle technical variation through covariate registration",
    "Core Capabilities": "scvi-tools provides models organized by data modality:\r\n\r\n### 1. Single-Cell RNA-seq Analysis\r\nCore models for expression analysis, batch correction, and integration. See `references/models-scrna-seq.md` for:\r\n- **scVI**: Unsupervised dimensionality reduction and batch correction\r\n- **scANVI**: Semi-supervised cell type annotation and integration\r\n- **AUTOZI**: Zero-inflation detection and modeling\r\n- **VeloVI**: RNA velocity analysis\r\n- **contrastiveVI**: Perturbation effect isolation\r\n\r\n### 2. Chromatin Accessibility (ATAC-seq)\r\nModels for analyzing single-cell chromatin data. See `references/models-atac-seq.md` for:\r\n- **PeakVI**: Peak-based ATAC-seq analysis and integration\r\n- **PoissonVI**: Quantitative fragment count modeling\r\n- **scBasset**: Deep learning approach with motif analysis\r\n\r\n### 3. Multimodal & Multi-omics Integration\r\nJoint analysis of multiple data types. See `references/models-multimodal.md` for:\r\n- **totalVI**: CITE-seq protein and RNA joint modeling\r\n- **MultiVI**: Paired and unpaired multi-omic integration\r\n- **MrVI**: Multi-resolution cross-sample analysis\r\n\r\n### 4. Spatial Transcriptomics\r\nSpatially-resolved transcriptomics analysis. See `references/models-spatial.md` for:\r\n- **DestVI**: Multi-resolution spatial deconvolution\r\n- **Stereoscope**: Cell type deconvolution\r\n- **Tangram**: Spatial mapping and integration\r\n- **scVIVA**: Cell-environment relationship analysis\r\n\r\n### 5. Specialized Modalities\r\nAdditional specialized analysis tools. See `references/models-specialized.md` for:\r\n- **MethylVI/MethylANVI**: Single-cell methylation analysis\r\n- **CytoVI**: Flow/mass cytometry batch correction\r\n- **Solo**: Doublet detection\r\n- **CellAssign**: Marker-based cell type annotation"
  }
}
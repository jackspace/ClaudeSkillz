{
  "description": "\"Biological data toolkit. Sequence analysis, alignments, phylogenetic trees, diversity metrics (alpha/beta, UniFrac), ordination (PCoA), PERMANOVA, FASTA/Newick I/O, for microbiome analysis.\"",
  "references": {
    "files": [
      "references/api_reference.md"
    ]
  },
  "content": "### 1. Sequence Manipulation\r\n\r\nWork with biological sequences using specialized classes for DNA, RNA, and protein data.\r\n\r\n**Key operations:**\r\n- Read/write sequences from FASTA, FASTQ, GenBank, EMBL formats\r\n- Sequence slicing, concatenation, and searching\r\n- Reverse complement, transcription (DNA→RNA), and translation (RNA→protein)\r\n- Find motifs and patterns using regex\r\n- Calculate distances (Hamming, k-mer based)\r\n- Handle sequence quality scores and metadata\r\n\r\n**Common patterns:**\r\n```python\r\nimport skbio\r\n\r\nseq = skbio.DNA.read('input.fasta')\r\n\r\nrc = seq.reverse_complement()\r\nrna = seq.transcribe()\r\nprotein = rna.translate()\r\n\r\nmotif_positions = seq.find_with_regex('ATG[ACGT]{3}')\r\n\r\nhas_degens = seq.has_degenerates()\r\nseq_no_gaps = seq.degap()\r\n```\r\n\r\n**Important notes:**\r\n- Use `DNA`, `RNA`, `Protein` classes for grammared sequences with validation\r\n- Use `Sequence` class for generic sequences without alphabet restrictions\r\n- Quality scores automatically loaded from FASTQ files into positional metadata\r\n- Metadata types: sequence-level (ID, description), positional (per-base), interval (regions/features)\r\n\r\n### 2. Sequence Alignment\r\n\r\nPerform pairwise and multiple sequence alignments using dynamic programming algorithms.\r\n\r\n**Key capabilities:**\r\n- Global alignment (Needleman-Wunsch with semi-global variant)\r\n- Local alignment (Smith-Waterman)\r\n- Configurable scoring schemes (match/mismatch, gap penalties, substitution matrices)\r\n- CIGAR string conversion\r\n- Multiple sequence alignment storage and manipulation with `TabularMSA`\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio.alignment import local_pairwise_align_ssw, TabularMSA\r\n\r\nalignment = local_pairwise_align_ssw(seq1, seq2)\r\n\r\nmsa = alignment.aligned_sequences\r\n\r\nmsa = TabularMSA.read('alignment.fasta', constructor=skbio.DNA)\r\n\r\nconsensus = msa.consensus()\r\n```\r\n\r\n**Important notes:**\r\n- Use `local_pairwise_align_ssw` for local alignments (faster, SSW-based)\r\n- Use `StripedSmithWaterman` for protein alignments\r\n- Affine gap penalties recommended for biological sequences\r\n- Can convert between scikit-bio, BioPython, and Biotite alignment formats\r\n\r\n### 3. Phylogenetic Trees\r\n\r\nConstruct, manipulate, and analyze phylogenetic trees representing evolutionary relationships.\r\n\r\n**Key capabilities:**\r\n- Tree construction from distance matrices (UPGMA, WPGMA, Neighbor Joining, GME, BME)\r\n- Tree manipulation (pruning, rerooting, traversal)\r\n- Distance calculations (patristic, cophenetic, Robinson-Foulds)\r\n- ASCII visualization\r\n- Newick format I/O\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio import TreeNode\r\nfrom skbio.tree import nj\r\n\r\ntree = TreeNode.read('tree.nwk')\r\n\r\ntree = nj(distance_matrix)\r\n\r\nsubtree = tree.shear(['taxon1', 'taxon2', 'taxon3'])\r\ntips = [node for node in tree.tips()]\r\nlca = tree.lowest_common_ancestor(['taxon1', 'taxon2'])\r\n\r\npatristic_dist = tree.find('taxon1').distance(tree.find('taxon2'))\r\ncophenetic_matrix = tree.cophenetic_matrix()\r\n\r\nrf_distance = tree.robinson_foulds(other_tree)\r\n```\r\n\r\n**Important notes:**\r\n- Use `nj()` for neighbor joining (classic phylogenetic method)\r\n- Use `upgma()` for UPGMA (assumes molecular clock)\r\n- GME and BME are highly scalable for large trees\r\n- Trees can be rooted or unrooted; some metrics require specific rooting\r\n\r\n### 4. Diversity Analysis\r\n\r\nCalculate alpha and beta diversity metrics for microbial ecology and community analysis.\r\n\r\n**Key capabilities:**\r\n- Alpha diversity: richness, Shannon entropy, Simpson index, Faith's PD, Pielou's evenness\r\n- Beta diversity: Bray-Curtis, Jaccard, weighted/unweighted UniFrac, Euclidean distances\r\n- Phylogenetic diversity metrics (require tree input)\r\n- Rarefaction and subsampling\r\n- Integration with ordination and statistical tests\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio.diversity import alpha_diversity, beta_diversity\r\nimport skbio\r\n\r\nalpha = alpha_diversity('shannon', counts_matrix, ids=sample_ids)\r\nfaith_pd = alpha_diversity('faith_pd', counts_matrix, ids=sample_ids,\r\n                          tree=tree, otu_ids=feature_ids)\r\n\r\nbc_dm = beta_diversity('braycurtis', counts_matrix, ids=sample_ids)\r\nunifrac_dm = beta_diversity('unweighted_unifrac', counts_matrix,\r\n                           ids=sample_ids, tree=tree, otu_ids=feature_ids)\r\n\r\nfrom skbio.diversity import get_alpha_diversity_metrics\r\nprint(get_alpha_diversity_metrics())\r\n```\r\n\r\n**Important notes:**\r\n- Counts must be integers representing abundances, not relative frequencies\r\n- Phylogenetic metrics (Faith's PD, UniFrac) require tree and OTU ID mapping\r\n- Use `partial_beta_diversity()` for computing specific sample pairs only\r\n- Alpha diversity returns Series, beta diversity returns DistanceMatrix\r\n\r\n### 5. Ordination Methods\r\n\r\nReduce high-dimensional biological data to visualizable lower-dimensional spaces.\r\n\r\n**Key capabilities:**\r\n- PCoA (Principal Coordinate Analysis) from distance matrices\r\n- CA (Correspondence Analysis) for contingency tables\r\n- CCA (Canonical Correspondence Analysis) with environmental constraints\r\n- RDA (Redundancy Analysis) for linear relationships\r\n- Biplot projection for feature interpretation\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio.stats.ordination import pcoa, cca\r\n\r\npcoa_results = pcoa(distance_matrix)\r\npc1 = pcoa_results.samples['PC1']\r\npc2 = pcoa_results.samples['PC2']\r\n\r\ncca_results = cca(species_matrix, environmental_matrix)\r\n\r\npcoa_results.write('ordination.txt')\r\nresults = skbio.OrdinationResults.read('ordination.txt')\r\n```\r\n\r\n**Important notes:**\r\n- PCoA works with any distance/dissimilarity matrix\r\n- CCA reveals environmental drivers of community composition\r\n- Ordination results include eigenvalues, proportion explained, and sample/feature coordinates\r\n- Results integrate with plotting libraries (matplotlib, seaborn, plotly)\r\n\r\n### 6. Statistical Testing\r\n\r\nPerform hypothesis tests specific to ecological and biological data.\r\n\r\n**Key capabilities:**\r\n- PERMANOVA: test group differences using distance matrices\r\n- ANOSIM: alternative test for group differences\r\n- PERMDISP: test homogeneity of group dispersions\r\n- Mantel test: correlation between distance matrices\r\n- Bioenv: find environmental variables correlated with distances\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio.stats.distance import permanova, anosim, mantel\r\n\r\npermanova_results = permanova(distance_matrix, grouping, permutations=999)\r\nprint(f\"p-value: {permanova_results['p-value']}\")\r\n\r\nanosim_results = anosim(distance_matrix, grouping, permutations=999)\r\n\r\nmantel_results = mantel(dm1, dm2, method='pearson', permutations=999)\r\nprint(f\"Correlation: {mantel_results[0]}, p-value: {mantel_results[1]}\")\r\n```\r\n\r\n**Important notes:**\r\n- Permutation tests provide non-parametric significance testing\r\n- Use 999+ permutations for robust p-values\r\n- PERMANOVA sensitive to dispersion differences; pair with PERMDISP\r\n- Mantel tests assess matrix correlation (e.g., geographic vs genetic distance)\r\n\r\n### 7. File I/O and Format Conversion\r\n\r\nRead and write 19+ biological file formats with automatic format detection.\r\n\r\n**Supported formats:**\r\n- Sequences: FASTA, FASTQ, GenBank, EMBL, QSeq\r\n- Alignments: Clustal, PHYLIP, Stockholm\r\n- Trees: Newick\r\n- Tables: BIOM (HDF5 and JSON)\r\n- Distances: delimited square matrices\r\n- Analysis: BLAST+6/7, GFF3, Ordination results\r\n- Metadata: TSV/CSV with validation\r\n\r\n**Common patterns:**\r\n```python\r\nimport skbio\r\n\r\nseq = skbio.DNA.read('file.fasta', format='fasta')\r\ntree = skbio.TreeNode.read('tree.nwk')\r\n\r\nseq.write('output.fasta', format='fasta')\r\n\r\nfor seq in skbio.io.read('large.fasta', format='fasta', constructor=skbio.DNA):\r\n    process(seq)\r\n\r\nseqs = list(skbio.io.read('input.fastq', format='fastq', constructor=skbio.DNA))\r\nskbio.io.write(seqs, format='fasta', into='output.fasta')\r\n```\r\n\r\n**Important notes:**\r\n- Use generators for large files to avoid memory issues\r\n- Format can be auto-detected when `into` parameter specified\r\n- Some objects can be written to multiple formats\r\n- Support for stdin/stdout piping with `verify=False`\r\n\r\n### 8. Distance Matrices\r\n\r\nCreate and manipulate distance/dissimilarity matrices with statistical methods.\r\n\r\n**Key capabilities:**\r\n- Store symmetric (DistanceMatrix) or asymmetric (DissimilarityMatrix) data\r\n- ID-based indexing and slicing\r\n- Integration with diversity, ordination, and statistical tests\r\n- Read/write delimited text format\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio import DistanceMatrix\r\nimport numpy as np\r\n\r\ndata = np.array([[0, 1, 2], [1, 0, 3], [2, 3, 0]])\r\ndm = DistanceMatrix(data, ids=['A', 'B', 'C'])\r\n\r\ndist_ab = dm['A', 'B']\r\nrow_a = dm['A']\r\n\r\ndm = DistanceMatrix.read('distances.txt')\r\n\r\npcoa_results = pcoa(dm)\r\npermanova_results = permanova(dm, grouping)\r\n```\r\n\r\n**Important notes:**\r\n- DistanceMatrix enforces symmetry and zero diagonal\r\n- DissimilarityMatrix allows asymmetric values\r\n- IDs enable integration with metadata and biological knowledge\r\n- Compatible with pandas, numpy, and scikit-learn\r\n\r\n### 9. Biological Tables\r\n\r\nWork with feature tables (OTU/ASV tables) common in microbiome research.\r\n\r\n**Key capabilities:**\r\n- BIOM format I/O (HDF5 and JSON)\r\n- Integration with pandas, polars, AnnData, numpy\r\n- Data augmentation techniques (phylomix, mixup, compositional methods)\r\n- Sample/feature filtering and normalization\r\n- Metadata integration\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio import Table\r\n\r\ntable = Table.read('table.biom')\r\n\r\nsample_ids = table.ids(axis='sample')\r\nfeature_ids = table.ids(axis='observation')\r\ncounts = table.matrix_data\r\n\r\nfiltered = table.filter(sample_ids_to_keep, axis='sample')\r\n\r\ndf = table.to_dataframe()\r\ntable = Table.from_dataframe(df)\r\n```\r\n\r\n**Important notes:**\r\n- BIOM tables are standard in QIIME 2 workflows\r\n- Rows typically represent samples, columns represent features (OTUs/ASVs)\r\n- Supports sparse and dense representations\r\n- Output format configurable (pandas/polars/numpy)\r\n\r\n### 10. Protein Embeddings\r\n\r\nWork with protein language model embeddings for downstream analysis.\r\n\r\n**Key capabilities:**\r\n- Store embeddings from protein language models (ESM, ProtTrans, etc.)\r\n- Convert embeddings to distance matrices\r\n- Generate ordination objects for visualization\r\n- Export to numpy/pandas for ML workflows\r\n\r\n**Common patterns:**\r\n```python\r\nfrom skbio.embedding import ProteinEmbedding, ProteinVector\r\n\r\nembedding = ProteinEmbedding(embedding_array, sequence_ids)\r\n\r\ndm = embedding.to_distances(metric='euclidean')\r\n\r\npcoa_results = embedding.to_ordination(metric='euclidean', method='pcoa')\r\n\r\n\r\n### Installation\r\n```bash\r\npip install scikit-bio",
  "name": "scikit-bio",
  "id": "scientific-pkg-scikit-bio",
  "sections": {
    "Reference Documentation": "For detailed API information, parameter specifications, and advanced usage examples, refer to `references/api_reference.md` which contains comprehensive documentation on:\r\n- Complete method signatures and parameters for all capabilities\r\n- Extended code examples for complex workflows\r\n- Troubleshooting common issues\r\n- Performance optimization tips\r\n- Integration patterns with other libraries",
    "Additional Resources": "- Official documentation: https://scikit.bio/docs/latest/\r\n- GitHub repository: https://github.com/scikit-bio/scikit-bio\r\n- Forum support: https://forum.qiime2.org (scikit-bio is part of QIIME 2 ecosystem)",
    "Overview": "scikit-bio is a comprehensive Python library for working with biological data. Apply this skill for bioinformatics analyses spanning sequence manipulation, alignment, phylogenetics, microbial ecology, and multivariate statistics.",
    "Best Practices": "conda install -c conda-forge scikit-bio\r\n```\r\n\r\n### Performance Considerations\r\n- Use generators for large sequence files to minimize memory usage\r\n- For massive phylogenetic trees, prefer GME or BME over NJ\r\n- Beta diversity calculations can be parallelized with `partial_beta_diversity()`\r\n- BIOM format (HDF5) more efficient than JSON for large tables\r\n\r\n### Integration with Ecosystem\r\n- Sequences interoperate with Biopython via standard formats\r\n- Tables integrate with pandas, polars, and AnnData\r\n- Distance matrices compatible with scikit-learn\r\n- Ordination results visualizable with matplotlib/seaborn/plotly\r\n- Works seamlessly with QIIME 2 artifacts (BIOM, trees, distance matrices)\r\n\r\n### Common Workflows\r\n1. **Microbiome diversity analysis**: Read BIOM table → Calculate alpha/beta diversity → Ordination (PCoA) → Statistical testing (PERMANOVA)\r\n2. **Phylogenetic analysis**: Read sequences → Align → Build distance matrix → Construct tree → Calculate phylogenetic distances\r\n3. **Sequence processing**: Read FASTQ → Quality filter → Trim/clean → Find motifs → Translate → Write FASTA\r\n4. **Comparative genomics**: Read sequences → Pairwise alignment → Calculate distances → Build tree → Analyze clades",
    "When to Use This Skill": "This skill should be used when the user:\r\n- Works with biological sequences (DNA, RNA, protein)\r\n- Needs to read/write biological file formats (FASTA, FASTQ, GenBank, Newick, BIOM, etc.)\r\n- Performs sequence alignments or searches for motifs\r\n- Constructs or analyzes phylogenetic trees\r\n- Calculates diversity metrics (alpha/beta diversity, UniFrac distances)\r\n- Performs ordination analysis (PCoA, CCA, RDA)\r\n- Runs statistical tests on biological/ecological data (PERMANOVA, ANOSIM, Mantel)\r\n- Analyzes microbiome or community ecology data\r\n- Works with protein embeddings from language models\r\n- Needs to manipulate biological data tables",
    "Core Capabilities": "array = embedding.to_array()\r\ndf = embedding.to_dataframe()\r\n```\r\n\r\n**Important notes:**\r\n- Embeddings bridge protein language models with traditional bioinformatics\r\n- Compatible with scikit-bio's distance/ordination/statistics ecosystem\r\n- SequenceEmbedding and ProteinEmbedding provide specialized functionality\r\n- Useful for sequence clustering, classification, and visualization"
  }
}
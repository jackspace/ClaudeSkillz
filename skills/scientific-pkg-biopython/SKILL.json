{
  "description": "\"Primary Python toolkit for molecular biology. Preferred for Python-based PubMed/NCBI queries (Bio.Entrez), sequence manipulation, file parsing (FASTA, GenBank, FASTQ, PDB), advanced BLAST workflows, structures, phylogenetics. For quick BLAST, use gget. For direct REST API, use pubmed-database.\"",
  "references": {
    "files": [
      "references/advanced.md",
      "references/alignment.md",
      "references/blast.md",
      "references/databases.md",
      "references/phylogenetics.md",
      "references/sequence_io.md",
      "references/structure.md"
    ]
  },
  "content": "Install Biopython using pip (requires Python 3 and NumPy):\r\n\r\n```python\r\npip install biopython\r\n```\r\n\r\nFor NCBI database access, always set your email address (required by NCBI):\r\n\r\n```python\r\nfrom Bio import Entrez\r\nEntrez.email = \"your.email@example.com\"\r\n\r\n\r\nThis skill provides comprehensive documentation organized by functionality area. When working on a task, consult the relevant reference documentation:\r\n\r\n### 1. Sequence Handling (Bio.Seq & Bio.SeqIO)\r\n\r\n**Reference:** `references/sequence_io.md`\r\n\r\nUse for:\r\n- Creating and manipulating biological sequences\r\n- Reading and writing sequence files (FASTA, GenBank, FASTQ, etc.)\r\n- Converting between file formats\r\n- Extracting sequences from large files\r\n- Sequence translation, transcription, and reverse complement\r\n- Working with SeqRecord objects\r\n\r\n**Quick example:**\r\n```python\r\nfrom Bio import SeqIO\r\n\r\nfor record in SeqIO.parse(\"sequences.fasta\", \"fasta\"):\r\n    print(f\"{record.id}: {len(record.seq)} bp\")\r\n\r\nSeqIO.convert(\"input.gb\", \"genbank\", \"output.fasta\", \"fasta\")\r\n```\r\n\r\n### 2. Alignment Analysis (Bio.Align & Bio.AlignIO)\r\n\r\n**Reference:** `references/alignment.md`\r\n\r\nUse for:\r\n- Pairwise sequence alignment (global and local)\r\n- Reading and writing multiple sequence alignments\r\n- Using substitution matrices (BLOSUM, PAM)\r\n- Calculating alignment statistics\r\n- Customizing alignment parameters\r\n\r\n**Quick example:**\r\n```python\r\nfrom Bio import Align\r\n\r\naligner = Align.PairwiseAligner()\r\naligner.mode = 'global'\r\nalignments = aligner.align(\"ACCGGT\", \"ACGGT\")\r\nprint(alignments[0])\r\n```\r\n\r\n### 3. Database Access (Bio.Entrez)\r\n\r\n**Reference:** `references/databases.md`\r\n\r\nUse for:\r\n- Searching NCBI databases (PubMed, GenBank, Protein, Gene, etc.)\r\n- Downloading sequences and records\r\n- Fetching publication information\r\n- Finding related records across databases\r\n- Batch downloading with proper rate limiting\r\n\r\n**Quick example:**\r\n```python\r\nfrom Bio import Entrez\r\nEntrez.email = \"your.email@example.com\"\r\n\r\nhandle = Entrez.esearch(db=\"pubmed\", term=\"biopython\", retmax=10)\r\nresults = Entrez.read(handle)\r\nhandle.close()\r\nprint(f\"Found {results['Count']} results\")\r\n```\r\n\r\n### 4. BLAST Operations (Bio.Blast)\r\n\r\n**Reference:** `references/blast.md`\r\n\r\nUse for:\r\n- Running BLAST searches via NCBI web services\r\n- Running local BLAST searches\r\n- Parsing BLAST XML output\r\n- Filtering results by E-value or identity\r\n- Extracting hit sequences\r\n\r\n**Quick example:**\r\n```python\r\nfrom Bio.Blast import NCBIWWW, NCBIXML\r\n\r\nresult_handle = NCBIWWW.qblast(\"blastn\", \"nt\", \"ATCGATCGATCG\")\r\nblast_record = NCBIXML.read(result_handle)\r\n\r\nfor alignment in blast_record.alignments[:5]:\r\n    print(f\"{alignment.title}: E-value={alignment.hsps[0].expect}\")\r\n```\r\n\r\n### 5. Structural Bioinformatics (Bio.PDB)\r\n\r\n**Reference:** `references/structure.md`\r\n\r\nUse for:\r\n- Parsing PDB and mmCIF structure files\r\n- Navigating protein structure hierarchy (SMCRA: Structure/Model/Chain/Residue/Atom)\r\n- Calculating distances, angles, and dihedrals\r\n- Secondary structure assignment (DSSP)\r\n- Structure superimposition and RMSD calculation\r\n- Extracting sequences from structures\r\n\r\n**Quick example:**\r\n```python\r\nfrom Bio.PDB import PDBParser\r\n\r\nparser = PDBParser(QUIET=True)\r\nstructure = parser.get_structure(\"1crn\", \"1crn.pdb\")\r\n\r\nchain = structure[0][\"A\"]\r\ndistance = chain[10][\"CA\"] - chain[20][\"CA\"]\r\nprint(f\"Distance: {distance:.2f} Ã…\")\r\n```\r\n\r\n### 6. Phylogenetics (Bio.Phylo)\r\n\r\n**Reference:** `references/phylogenetics.md`\r\n\r\nUse for:\r\n- Reading and writing phylogenetic trees (Newick, NEXUS, phyloXML)\r\n- Building trees from distance matrices or alignments\r\n- Tree manipulation (pruning, rerooting, ladderizing)\r\n- Calculating phylogenetic distances\r\n- Creating consensus trees\r\n- Visualizing trees\r\n\r\n**Quick example:**\r\n```python\r\nfrom Bio import Phylo\r\n\r\ntree = Phylo.read(\"tree.nwk\", \"newick\")\r\nPhylo.draw_ascii(tree)\r\n\r\n\r\n### Reading Documentation\r\n\r\nWhen a user asks about a specific Biopython task:\r\n\r\n1. **Identify the relevant module** based on the task description\r\n2. **Read the appropriate reference file** using the Read tool\r\n3. **Extract relevant code patterns** and adapt them to the user's specific needs\r\n4. **Combine multiple modules** when the task requires it\r\n\r\nExample search patterns for reference files:\r\n```bash\r\ngrep -n \"SeqIO.parse\" references/sequence_io.md\r\n\r\ngrep -n \"BLAST\" references/blast.md\r\n\r\n\r\n### Pattern 1: Fetch Sequence from GenBank\r\n\r\n```python\r\nfrom Bio import Entrez, SeqIO\r\n\r\nEntrez.email = \"your.email@example.com\"\r\n\r\nhandle = Entrez.efetch(db=\"nucleotide\", id=\"EU490707\", rettype=\"gb\", retmode=\"text\")\r\nrecord = SeqIO.read(handle, \"genbank\")\r\nhandle.close()\r\n\r\nprint(f\"Description: {record.description}\")\r\nprint(f\"Sequence length: {len(record.seq)}\")\r\n```\r\n\r\n### Pattern 2: Sequence Analysis Pipeline\r\n\r\n```python\r\nfrom Bio import SeqIO\r\nfrom Bio.SeqUtils import gc_fraction\r\n\r\nfor record in SeqIO.parse(\"sequences.fasta\", \"fasta\"):\r\n    # Calculate statistics\r\n    gc = gc_fraction(record.seq)\r\n    length = len(record.seq)\r\n\r\n    # Find ORFs, translate, etc.\r\n    protein = record.seq.translate()\r\n\r\n    print(f\"{record.id}: {length} bp, GC={gc:.2%}\")\r\n```\r\n\r\n### Pattern 3: BLAST and Fetch Top Hits\r\n\r\n```python\r\nfrom Bio.Blast import NCBIWWW, NCBIXML\r\nfrom Bio import Entrez, SeqIO\r\n\r\nEntrez.email = \"your.email@example.com\"\r\n\r\nresult_handle = NCBIWWW.qblast(\"blastn\", \"nt\", sequence)\r\nblast_record = NCBIXML.read(result_handle)\r\n\r\naccessions = [aln.accession for aln in blast_record.alignments[:5]]\r\n\r\nfor acc in accessions:\r\n    handle = Entrez.efetch(db=\"nucleotide\", id=acc, rettype=\"fasta\", retmode=\"text\")\r\n    record = SeqIO.read(handle, \"fasta\")\r\n    handle.close()\r\n    print(f\">{record.description}\")\r\n```\r\n\r\n### Pattern 4: Build Phylogenetic Tree from Sequences\r\n\r\n```python\r\nfrom Bio import AlignIO, Phylo\r\nfrom Bio.Phylo.TreeConstruction import DistanceCalculator, DistanceTreeConstructor\r\n\r\nalignment = AlignIO.read(\"alignment.fasta\", \"fasta\")\r\n\r\ncalculator = DistanceCalculator(\"identity\")\r\ndm = calculator.get_distance(alignment)\r\n\r\nconstructor = DistanceTreeConstructor()\r\ntree = constructor.nj(dm)\r\n\r\n\r\nTo locate information in reference files, use these search patterns:\r\n\r\n```bash\r\ngrep -n \"function_name\" references/*.md\r\n\r\ngrep -n \"example\" references/sequence_io.md",
  "name": "biopython",
  "id": "scientific-pkg-biopython",
  "sections": {
    "Using This Skill": "distance = tree.distance(\"Species_A\", \"Species_B\")\r\nprint(f\"Distance: {distance:.3f}\")\r\n```\r\n\r\n### 7. Advanced Features\r\n\r\n**Reference:** `references/advanced.md`\r\n\r\nUse for:\r\n- **Sequence motifs** (Bio.motifs) - Finding and analyzing motif patterns\r\n- **Population genetics** (Bio.PopGen) - GenePop files, Fst calculations, Hardy-Weinberg tests\r\n- **Sequence utilities** (Bio.SeqUtils) - GC content, melting temperature, molecular weight, protein analysis\r\n- **Restriction analysis** (Bio.Restriction) - Finding restriction enzyme sites\r\n- **Clustering** (Bio.Cluster) - K-means and hierarchical clustering\r\n- **Genome diagrams** (GenomeDiagram) - Visualizing genomic features\r\n\r\n**Quick example:**\r\n```python\r\nfrom Bio.SeqUtils import gc_fraction, molecular_weight\r\nfrom Bio.Seq import Seq\r\n\r\nseq = Seq(\"ATCGATCGATCG\")\r\nprint(f\"GC content: {gc_fraction(seq):.2%}\")\r\nprint(f\"Molecular weight: {molecular_weight(seq, seq_type='DNA'):.2f} g/mol\")\r\n```",
    "Common Patterns": "Phylo.draw_ascii(tree)\r\n```",
    "Additional Resources": "- **Official Documentation**: https://biopython.org/docs/latest/\r\n- **Tutorial**: https://biopython.org/docs/latest/Tutorial/\r\n- **Cookbook**: https://biopython.org/docs/latest/Tutorial/ (advanced examples)\r\n- **GitHub**: https://github.com/biopython/biopython\r\n- **Mailing List**: biopython@biopython.org",
    "Overview": "Biopython is a comprehensive set of freely available Python tools for biological computation. It provides functionality for sequence manipulation, file I/O, database access, structural bioinformatics, phylogenetics, and many other bioinformatics tasks. The current version is **Biopython 1.85** (released January 2025), which supports Python 3 and requires NumPy.",
    "Installation and Setup": "Entrez.api_key = \"your_api_key_here\"\r\n```",
    "Best Practices": "1. **Always read relevant reference documentation** before writing code\r\n2. **Use grep to search reference files** for specific functions or examples\r\n3. **Validate file formats** before parsing\r\n4. **Handle missing data gracefully** - Not all records have all fields\r\n5. **Cache downloaded data** - Don't repeatedly download the same sequences\r\n6. **Respect NCBI rate limits** - Use API keys and proper delays\r\n7. **Test with small datasets** before processing large files\r\n8. **Keep Biopython updated** to get latest features and bug fixes\r\n9. **Use appropriate genetic code tables** for translation\r\n10. **Document analysis parameters** for reproducibility",
    "When to Use This Skill": "Use this skill when:\r\n\r\n- Working with biological sequences (DNA, RNA, or protein)\r\n- Reading, writing, or converting biological file formats (FASTA, GenBank, FASTQ, PDB, mmCIF, etc.)\r\n- Accessing NCBI databases (GenBank, PubMed, Protein, Gene, etc.) via Entrez\r\n- Running BLAST searches or parsing BLAST results\r\n- Performing sequence alignments (pairwise or multiple sequence alignments)\r\n- Analyzing protein structures from PDB files\r\n- Creating, manipulating, or visualizing phylogenetic trees\r\n- Finding sequence motifs or analyzing motif patterns\r\n- Calculating sequence statistics (GC content, molecular weight, melting temperature, etc.)\r\n- Performing structural bioinformatics tasks\r\n- Working with population genetics data\r\n- Any other computational molecular biology task",
    "Summary": "Biopython provides comprehensive tools for computational molecular biology. When using this skill:\r\n\r\n1. **Identify the task domain** (sequences, alignments, databases, BLAST, structures, phylogenetics, or advanced)\r\n2. **Consult the appropriate reference file** in the `references/` directory\r\n3. **Adapt code examples** to the specific use case\r\n4. **Combine multiple modules** when needed for complex workflows\r\n5. **Follow best practices** for file handling, error checking, and data management\r\n\r\nThe modular reference documentation ensures detailed, searchable information for every major Biopython capability.",
    "Core Capabilities": "Biopython is organized into modular sub-packages, each addressing specific bioinformatics domains:\r\n\r\n1. **Sequence Handling** - Bio.Seq and Bio.SeqIO for sequence manipulation and file I/O\r\n2. **Alignment Analysis** - Bio.Align and Bio.AlignIO for pairwise and multiple sequence alignments\r\n3. **Database Access** - Bio.Entrez for programmatic access to NCBI databases\r\n4. **BLAST Operations** - Bio.Blast for running and parsing BLAST searches\r\n5. **Structural Bioinformatics** - Bio.PDB for working with 3D protein structures\r\n6. **Phylogenetics** - Bio.Phylo for phylogenetic tree manipulation and visualization\r\n7. **Advanced Features** - Motifs, population genetics, sequence utilities, and more",
    "Troubleshooting Common Issues": "### Issue: \"No handlers could be found for logger 'Bio.Entrez'\"\r\n**Solution:** This is just a warning. Set Entrez.email to suppress it.\r\n\r\n### Issue: \"HTTP Error 400\" from NCBI\r\n**Solution:** Check that IDs/accessions are valid and properly formatted.\r\n\r\n### Issue: \"ValueError: EOF\" when parsing files\r\n**Solution:** Verify file format matches the specified format string.\r\n\r\n### Issue: Alignment fails with \"sequences are not the same length\"\r\n**Solution:** Ensure sequences are aligned before using AlignIO or MultipleSeqAlignment.\r\n\r\n### Issue: BLAST searches are slow\r\n**Solution:** Use local BLAST for large-scale searches, or cache results.\r\n\r\n### Issue: PDB parser warnings\r\n**Solution:** Use `PDBParser(QUIET=True)` to suppress warnings, or investigate structure quality.",
    "General Workflow Guidelines": "grep -n \"alignment\" references/alignment.md\r\n```\r\n\r\n### Writing Biopython Code\r\n\r\nFollow these principles when writing Biopython code:\r\n\r\n1. **Import modules explicitly**\r\n   ```python\r\n   from Bio import SeqIO, Entrez\r\n   from Bio.Seq import Seq\r\n   ```\r\n\r\n2. **Set Entrez email** when using NCBI databases\r\n   ```python\r\n   Entrez.email = \"your.email@example.com\"\r\n   ```\r\n\r\n3. **Use appropriate file formats** - Check which format best suits the task\r\n   ```python\r\n   # Common formats: \"fasta\", \"genbank\", \"fastq\", \"clustal\", \"phylip\"\r\n   ```\r\n\r\n4. **Handle files properly** - Close handles after use or use context managers\r\n   ```python\r\n   with open(\"file.fasta\") as handle:\r\n       records = SeqIO.parse(handle, \"fasta\")\r\n   ```\r\n\r\n5. **Use iterators for large files** - Avoid loading everything into memory\r\n   ```python\r\n   for record in SeqIO.parse(\"large_file.fasta\", \"fasta\"):\r\n       # Process one record at a time\r\n   ```\r\n\r\n6. **Handle errors gracefully** - Network operations and file parsing can fail\r\n   ```python\r\n   try:\r\n       handle = Entrez.efetch(db=\"nucleotide\", id=accession)\r\n   except HTTPError as e:\r\n       print(f\"Error: {e}\")\r\n   ```",
    "Quick Reference": "grep -n \"Bio.Seq\" references/*.md\r\n```"
  }
}
{
  "description": "\"Constraint-based metabolic modeling (COBRA). FBA, FVA, gene knockouts, flux sampling, SBML models, for systems biology and metabolic engineering analysis.\"",
  "references": {
    "files": [
      "references/api_quick_reference.md",
      "references/workflows.md"
    ]
  },
  "content": "COBRApy provides comprehensive tools organized into several key areas:\r\n\r\n### 1. Model Management\r\n\r\nLoad existing models from repositories or files:\r\n```python\r\nfrom cobra.io import load_model\r\n\r\nmodel = load_model(\"textbook\")  # E. coli core model\r\nmodel = load_model(\"ecoli\")     # Full E. coli model\r\nmodel = load_model(\"salmonella\")\r\n\r\nfrom cobra.io import read_sbml_model, load_json_model, load_yaml_model\r\nmodel = read_sbml_model(\"path/to/model.xml\")\r\nmodel = load_json_model(\"path/to/model.json\")\r\nmodel = load_yaml_model(\"path/to/model.yml\")\r\n```\r\n\r\nSave models in various formats:\r\n```python\r\nfrom cobra.io import write_sbml_model, save_json_model, save_yaml_model\r\nwrite_sbml_model(model, \"output.xml\")  # Preferred format\r\nsave_json_model(model, \"output.json\")  # For Escher compatibility\r\nsave_yaml_model(model, \"output.yml\")   # Human-readable\r\n```\r\n\r\n### 2. Model Structure and Components\r\n\r\nAccess and inspect model components:\r\n```python\r\nmodel.reactions      # DictList of all reactions\r\nmodel.metabolites    # DictList of all metabolites\r\nmodel.genes          # DictList of all genes\r\n\r\nreaction = model.reactions.get_by_id(\"PFK\")\r\nmetabolite = model.metabolites[0]\r\n\r\nprint(reaction.reaction)        # Stoichiometric equation\r\nprint(reaction.bounds)          # Flux constraints\r\nprint(reaction.gene_reaction_rule)  # GPR logic\r\nprint(metabolite.formula)       # Chemical formula\r\nprint(metabolite.compartment)   # Cellular location\r\n```\r\n\r\n### 3. Flux Balance Analysis (FBA)\r\n\r\nPerform standard FBA simulation:\r\n```python\r\nsolution = model.optimize()\r\nprint(f\"Objective value: {solution.objective_value}\")\r\nprint(f\"Status: {solution.status}\")\r\n\r\nprint(solution.fluxes[\"PFK\"])\r\nprint(solution.fluxes.head())\r\n\r\nobjective_value = model.slim_optimize()\r\n\r\nmodel.objective = \"ATPM\"\r\nsolution = model.optimize()\r\n```\r\n\r\nParsimonious FBA (minimize total flux):\r\n```python\r\nfrom cobra.flux_analysis import pfba\r\nsolution = pfba(model)\r\n```\r\n\r\nGeometric FBA (find central solution):\r\n```python\r\nfrom cobra.flux_analysis import geometric_fba\r\nsolution = geometric_fba(model)\r\n```\r\n\r\n### 4. Flux Variability Analysis (FVA)\r\n\r\nDetermine flux ranges for all reactions:\r\n```python\r\nfrom cobra.flux_analysis import flux_variability_analysis\r\n\r\nfva_result = flux_variability_analysis(model)\r\n\r\nfva_result = flux_variability_analysis(model, fraction_of_optimum=0.9)\r\n\r\nfva_result = flux_variability_analysis(model, loopless=True)\r\n\r\nfva_result = flux_variability_analysis(\r\n    model,\r\n    reaction_list=[\"PFK\", \"FBA\", \"PGI\"]\r\n)\r\n```\r\n\r\n### 5. Gene and Reaction Deletion Studies\r\n\r\nPerform knockout analyses:\r\n```python\r\nfrom cobra.flux_analysis import (\r\n    single_gene_deletion,\r\n    single_reaction_deletion,\r\n    double_gene_deletion,\r\n    double_reaction_deletion\r\n)\r\n\r\ngene_results = single_gene_deletion(model)\r\nreaction_results = single_reaction_deletion(model)\r\n\r\ndouble_gene_results = double_gene_deletion(\r\n    model,\r\n    processes=4  # Number of CPU cores\r\n)\r\n\r\nwith model:\r\n    model.genes.get_by_id(\"b0008\").knock_out()\r\n    solution = model.optimize()\r\n    print(f\"Growth after knockout: {solution.objective_value}\")\r\n```\r\n\r\n### 6. Growth Media and Minimal Media\r\n\r\nManage growth medium:\r\n```python\r\nprint(model.medium)\r\n\r\nmedium = model.medium\r\nmedium[\"EX_glc__D_e\"] = 10.0  # Set glucose uptake\r\nmedium[\"EX_o2_e\"] = 0.0       # Anaerobic conditions\r\nmodel.medium = medium\r\n\r\nfrom cobra.medium import minimal_medium\r\n\r\nmin_medium = minimal_medium(model, minimize_components=False)\r\n\r\nmin_medium = minimal_medium(\r\n    model,\r\n    minimize_components=True,\r\n    open_exchanges=True\r\n)\r\n```\r\n\r\n### 7. Flux Sampling\r\n\r\nSample the feasible flux space:\r\n```python\r\nfrom cobra.sampling import sample\r\n\r\nsamples = sample(model, n=1000, method=\"optgp\", processes=4)\r\n\r\nsamples = sample(model, n=1000, method=\"achr\")\r\n\r\nfrom cobra.sampling import OptGPSampler\r\nsampler = OptGPSampler(model, processes=4)\r\nsampler.sample(1000)\r\nvalidation = sampler.validate(sampler.samples)\r\nprint(validation.value_counts())  # Should be all 'v' for valid\r\n```\r\n\r\n### 8. Production Envelopes\r\n\r\nCalculate phenotype phase planes:\r\n```python\r\nfrom cobra.flux_analysis import production_envelope\r\n\r\nenvelope = production_envelope(\r\n    model,\r\n    reactions=[\"EX_glc__D_e\", \"EX_o2_e\"],\r\n    objective=\"EX_ac_e\"  # Acetate production\r\n)\r\n\r\nenvelope = production_envelope(\r\n    model,\r\n    reactions=[\"EX_glc__D_e\", \"EX_o2_e\"],\r\n    carbon_sources=\"EX_glc__D_e\"\r\n)\r\n\r\nimport matplotlib.pyplot as plt\r\nenvelope.plot(x=\"EX_glc__D_e\", y=\"EX_o2_e\", kind=\"scatter\")\r\nplt.show()\r\n```\r\n\r\n### 9. Gapfilling\r\n\r\nAdd reactions to make models feasible:\r\n```python\r\nfrom cobra.flux_analysis import gapfill\r\n\r\nuniversal = load_model(\"universal\")\r\n\r\nwith model:\r\n    # Remove reactions to create gaps for demonstration\r\n    model.remove_reactions([model.reactions.PGI])\r\n\r\n    # Find reactions needed\r\n    solution = gapfill(model, universal)\r\n    print(f\"Reactions to add: {solution}\")\r\n```\r\n\r\n### 10. Model Building\r\n\r\nBuild models from scratch:\r\n```python\r\nfrom cobra import Model, Reaction, Metabolite\r\n\r\nmodel = Model(\"my_model\")\r\n\r\natp_c = Metabolite(\"atp_c\", formula=\"C10H12N5O13P3\",\r\n                   name=\"ATP\", compartment=\"c\")\r\nadp_c = Metabolite(\"adp_c\", formula=\"C10H12N5O10P2\",\r\n                   name=\"ADP\", compartment=\"c\")\r\npi_c = Metabolite(\"pi_c\", formula=\"HO4P\",\r\n                  name=\"Phosphate\", compartment=\"c\")\r\n\r\nreaction = Reaction(\"ATPASE\")\r\nreaction.name = \"ATP hydrolysis\"\r\nreaction.subsystem = \"Energy\"\r\nreaction.lower_bound = 0.0\r\nreaction.upper_bound = 1000.0\r\n\r\nreaction.add_metabolites({\r\n    atp_c: -1.0,\r\n    adp_c: 1.0,\r\n    pi_c: 1.0\r\n})\r\n\r\nreaction.gene_reaction_rule = \"(gene1 and gene2) or gene3\"\r\n\r\nmodel.add_reactions([reaction])\r\n\r\nmodel.add_boundary(atp_c, type=\"exchange\")\r\nmodel.add_boundary(adp_c, type=\"demand\")\r\n\r\n\r\n### Workflow 1: Load Model and Predict Growth\r\n\r\n```python\r\nfrom cobra.io import load_model\r\n\r\nmodel = load_model(\"ecoli\")\r\n\r\nsolution = model.optimize()\r\nprint(f\"Growth rate: {solution.objective_value:.3f} /h\")\r\n\r\nprint(solution.fluxes[solution.fluxes.abs() > 1e-6])\r\n```\r\n\r\n### Workflow 2: Gene Knockout Screen\r\n\r\n```python\r\nfrom cobra.io import load_model\r\nfrom cobra.flux_analysis import single_gene_deletion\r\n\r\nmodel = load_model(\"ecoli\")\r\n\r\nresults = single_gene_deletion(model)\r\n\r\nessential_genes = results[results[\"growth\"] < 0.01]\r\nprint(f\"Found {len(essential_genes)} essential genes\")\r\n\r\nneutral_genes = results[results[\"growth\"] > 0.9 * solution.objective_value]\r\n```\r\n\r\n### Workflow 3: Media Optimization\r\n\r\n```python\r\nfrom cobra.io import load_model\r\nfrom cobra.medium import minimal_medium\r\n\r\nmodel = load_model(\"ecoli\")\r\n\r\ntarget_growth = model.slim_optimize() * 0.5\r\nmin_medium = minimal_medium(\r\n    model,\r\n    target_growth,\r\n    minimize_components=True\r\n)\r\n\r\nprint(f\"Minimal medium components: {len(min_medium)}\")\r\nprint(min_medium)\r\n```\r\n\r\n### Workflow 4: Flux Uncertainty Analysis\r\n\r\n```python\r\nfrom cobra.io import load_model\r\nfrom cobra.flux_analysis import flux_variability_analysis\r\nfrom cobra.sampling import sample\r\n\r\nmodel = load_model(\"ecoli\")\r\n\r\nfva = flux_variability_analysis(model, fraction_of_optimum=1.0)\r\n\r\nsamples = sample(model, n=1000)\r\n\r\nreaction_id = \"PFK\"\r\nimport matplotlib.pyplot as plt\r\nsamples[reaction_id].hist(bins=50)\r\nplt.xlabel(f\"Flux through {reaction_id}\")\r\nplt.ylabel(\"Frequency\")\r\nplt.show()\r\n```\r\n\r\n### Workflow 5: Context Manager for Temporary Changes\r\n\r\nUse context managers to make temporary modifications:\r\n```python\r\nwith model:\r\n    # Temporarily change objective\r\n    model.objective = \"ATPM\"\r\n\r\n    # Temporarily modify bounds\r\n    model.reactions.EX_glc__D_e.lower_bound = -5.0\r\n\r\n    # Temporarily knock out genes\r\n    model.genes.b0008.knock_out()\r\n\r\n    # Optimize with changes\r\n    solution = model.optimize()\r\n    print(f\"Modified growth: {solution.objective_value}\")\r\n\r\n\r\n### DictList Objects\r\nModels use `DictList` objects for reactions, metabolites, and genes - behaving like both lists and dictionaries:\r\n```python\r\nfirst_reaction = model.reactions[0]\r\n\r\npfk = model.reactions.get_by_id(\"PFK\")\r\n\r\natp_reactions = model.reactions.query(\"atp\")\r\n```\r\n\r\n### Flux Constraints\r\nReaction bounds define feasible flux ranges:\r\n- **Irreversible**: `lower_bound = 0, upper_bound > 0`\r\n- **Reversible**: `lower_bound < 0, upper_bound > 0`\r\n- Set both bounds simultaneously with `.bounds` to avoid inconsistencies\r\n\r\n### Gene-Reaction Rules (GPR)\r\nBoolean logic linking genes to reactions:\r\n```python\r\nreaction.gene_reaction_rule = \"gene1 and gene2\"\r\n\r\nreaction.gene_reaction_rule = \"gene1 or gene2\"",
  "name": "cobrapy",
  "id": "scientific-pkg-cobrapy",
  "sections": {
    "Overview": "COBRApy is a Python library for constraint-based reconstruction and analysis (COBRA) of metabolic models, essential for systems biology research. Work with genome-scale metabolic models, perform computational simulations of cellular metabolism, conduct metabolic engineering analyses, and predict phenotypic behaviors.",
    "Troubleshooting": "**Infeasible solutions**: Check medium constraints, reaction bounds, and model consistency\r\n**Slow optimization**: Try different solvers (GLPK, CPLEX, Gurobi) via `model.solver`\r\n**Unbounded solutions**: Verify exchange reactions have appropriate upper bounds\r\n**Import errors**: Ensure correct file format and valid SBML identifiers",
    "Best Practices": "1. **Use context managers** for temporary modifications to avoid state management issues\r\n2. **Validate models** before analysis using `model.slim_optimize()` to ensure feasibility\r\n3. **Check solution status** after optimization - `optimal` indicates successful solve\r\n4. **Use loopless FVA** when thermodynamic feasibility matters\r\n5. **Set fraction_of_optimum** appropriately in FVA to explore suboptimal space\r\n6. **Parallelize** computationally expensive operations (sampling, double deletions)\r\n7. **Prefer SBML format** for model exchange and long-term storage\r\n8. **Use slim_optimize()** when only objective value needed for performance\r\n9. **Validate flux samples** to ensure numerical stability",
    "References": "For detailed workflows and API patterns, refer to:\r\n- `references/workflows.md` - Comprehensive step-by-step workflow examples\r\n- `references/api_quick_reference.md` - Common function signatures and patterns\r\n\r\nOfficial documentation: https://cobrapy.readthedocs.io/en/latest/",
    "Core Capabilities": "model.objective = \"ATPASE\"\r\n```",
    "Common Workflows": "solution = model.optimize()\r\nprint(f\"Original growth: {solution.objective_value}\")\r\n```",
    "Key Concepts": "reaction.gene_reaction_rule = \"(gene1 and gene2) or (gene3 and gene4)\"\r\n```\r\n\r\n### Exchange Reactions\r\nSpecial reactions representing metabolite import/export:\r\n- Named with prefix `EX_` by convention\r\n- Positive flux = secretion, negative flux = uptake\r\n- Managed through `model.medium` dictionary"
  }
}
{
  "description": "\"PDF generation toolkit. Create invoices, reports, certificates, forms, charts, tables, barcodes, QR codes, Canvas/Platypus APIs, for professional document automation.\"",
  "references": {
    "files": [
      "references/barcodes_reference.md",
      "references/canvas_api.md",
      "references/charts_reference.md",
      "references/pdf_features.md",
      "references/platypus_guide.md",
      "references/tables_reference.md",
      "references/text_and_fonts.md"
    ]
  },
  "content": "### Simple Canvas Document\r\n\r\n```python\r\nfrom reportlab.pdfgen import canvas\r\nfrom reportlab.lib.pagesizes import letter\r\nfrom reportlab.lib.units import inch\r\n\r\nc = canvas.Canvas(\"output.pdf\", pagesize=letter)\r\nwidth, height = letter\r\n\r\nc.setFont(\"Helvetica-Bold\", 24)\r\nc.drawString(inch, height - inch, \"Hello ReportLab!\")\r\n\r\nc.setFillColorRGB(0.2, 0.4, 0.8)\r\nc.rect(inch, 5*inch, 4*inch, 2*inch, fill=1)\r\n\r\nc.showPage()\r\nc.save()\r\n```\r\n\r\n### Simple Platypus Document\r\n\r\n```python\r\nfrom reportlab.lib.pagesizes import letter\r\nfrom reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer\r\nfrom reportlab.lib.styles import getSampleStyleSheet\r\nfrom reportlab.lib.units import inch\r\n\r\ndoc = SimpleDocTemplate(\"output.pdf\", pagesize=letter)\r\nstory = []\r\nstyles = getSampleStyleSheet()\r\n\r\nstory.append(Paragraph(\"Document Title\", styles['Title']))\r\nstory.append(Spacer(1, 0.2*inch))\r\nstory.append(Paragraph(\"This is body text with <b>bold</b> and <i>italic</i>.\", styles['BodyText']))\r\n\r\n\r\n### Creating Tables\r\n\r\nTables work with both Canvas (via Drawing) and Platypus (as Flowables):\r\n\r\n```python\r\nfrom reportlab.platypus import Table, TableStyle\r\nfrom reportlab.lib import colors\r\nfrom reportlab.lib.units import inch\r\n\r\ndata = [\r\n    ['Product', 'Q1', 'Q2', 'Q3', 'Q4'],\r\n    ['Widget A', '100', '150', '130', '180'],\r\n    ['Widget B', '80', '120', '110', '160'],\r\n]\r\n\r\ntable = Table(data, colWidths=[2*inch, 1*inch, 1*inch, 1*inch, 1*inch])\r\n\r\nstyle = TableStyle([\r\n    # Header row\r\n    ('BACKGROUND', (0, 0), (-1, 0), colors.darkblue),\r\n    ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),\r\n    ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),\r\n    ('ALIGN', (0, 0), (-1, -1), 'CENTER'),\r\n\r\n    # Data rows\r\n    ('ROWBACKGROUNDS', (0, 1), (-1, -1), [colors.white, colors.lightgrey]),\r\n    ('GRID', (0, 0), (-1, -1), 1, colors.black),\r\n])\r\n\r\ntable.setStyle(style)\r\n\r\nstory.append(table)\r\n\r\ntable.wrapOn(c, width, height)\r\ntable.drawOn(c, x, y)\r\n```\r\n\r\n**Detailed table reference:** See `references/tables_reference.md` for cell spanning, borders, alignment, and advanced styling.\r\n\r\n### Creating Charts\r\n\r\nCharts use the graphics framework and can be added to both Canvas and Platypus:\r\n\r\n```python\r\nfrom reportlab.graphics.shapes import Drawing\r\nfrom reportlab.graphics.charts.barcharts import VerticalBarChart\r\nfrom reportlab.lib import colors\r\n\r\ndrawing = Drawing(400, 200)\r\n\r\nchart = VerticalBarChart()\r\nchart.x = 50\r\nchart.y = 50\r\nchart.width = 300\r\nchart.height = 125\r\n\r\nchart.data = [[100, 150, 130, 180, 140]]\r\nchart.categoryAxis.categoryNames = ['Q1', 'Q2', 'Q3', 'Q4', 'Q5']\r\n\r\nchart.bars[0].fillColor = colors.blue\r\nchart.valueAxis.valueMin = 0\r\nchart.valueAxis.valueMax = 200\r\n\r\ndrawing.add(chart)\r\n\r\nstory.append(drawing)\r\n\r\nfrom reportlab.graphics import renderPDF\r\nrenderPDF.drawToFile(drawing, 'chart.pdf', 'Chart Title')\r\n```\r\n\r\n**Available chart types:** Bar (vertical/horizontal), Line, Pie, Area, Scatter\r\n**Detailed charts reference:** See `references/charts_reference.md` for all chart types, styling, legends, and customization.\r\n\r\n### Adding Barcodes and QR Codes\r\n\r\n```python\r\nfrom reportlab.graphics.barcode import code128\r\nfrom reportlab.graphics.barcode.qr import QrCodeWidget\r\nfrom reportlab.graphics.shapes import Drawing\r\nfrom reportlab.graphics import renderPDF\r\n\r\nbarcode = code128.Code128(\"ABC123456789\", barHeight=0.5*inch)\r\n\r\nbarcode.drawOn(c, x, y)\r\n\r\nqr = QrCodeWidget(\"https://example.com\")\r\nqr.barWidth = 2*inch\r\nqr.barHeight = 2*inch\r\n\r\nd = Drawing()\r\nd.add(qr)\r\nstory.append(d)\r\n```\r\n\r\n**Supported formats:** Code128, Code39, EAN-13, EAN-8, UPC-A, ISBN, QR, Data Matrix, and 20+ more\r\n**Detailed barcode reference:** See `references/barcodes_reference.md` for all formats and usage examples.\r\n\r\n### Working with Text and Fonts\r\n\r\n```python\r\nfrom reportlab.platypus import Paragraph\r\nfrom reportlab.lib.styles import ParagraphStyle\r\nfrom reportlab.lib.enums import TA_JUSTIFY\r\n\r\ncustom_style = ParagraphStyle(\r\n    'CustomStyle',\r\n    fontSize=12,\r\n    leading=14,           # Line spacing\r\n    alignment=TA_JUSTIFY,\r\n    spaceAfter=10,\r\n    textColor=colors.black,\r\n)\r\n\r\ntext = \"\"\"\r\nThis paragraph has <b>bold</b>, <i>italic</i>, and <u>underlined</u> text.\r\nYou can also use <font color=\"blue\">colors</font> and <font size=\"14\">different sizes</font>.\r\nChemical formula: H<sub>2</sub>O, Einstein: E=mc<sup>2</sup>\r\n\"\"\"\r\n\r\npara = Paragraph(text, custom_style)\r\nstory.append(para)\r\n```\r\n\r\n**Using custom fonts:**\r\n\r\n```python\r\nfrom reportlab.pdfbase import pdfmetrics\r\nfrom reportlab.pdfbase.ttfonts import TTFont\r\n\r\npdfmetrics.registerFont(TTFont('CustomFont', 'CustomFont.ttf'))\r\n\r\nc.setFont('CustomFont', 12)\r\n\r\nstyle = ParagraphStyle('Custom', fontName='CustomFont', fontSize=12)\r\n```\r\n\r\n**Detailed text reference:** See `references/text_and_fonts.md` for paragraph styles, font families, Asian languages, Greek letters, and formatting.\r\n\r\n### Adding Images\r\n\r\n```python\r\nfrom reportlab.platypus import Image\r\nfrom reportlab.lib.units import inch\r\n\r\nimg = Image('photo.jpg', width=4*inch, height=3*inch)\r\nstory.append(img)\r\n\r\nimg = Image('photo.jpg', width=4*inch, height=3*inch, kind='proportional')\r\n\r\nc.drawImage('photo.jpg', x, y, width=4*inch, height=3*inch)\r\n\r\nc.drawImage('logo.png', x, y, mask=[255,255,255,255,255,255])\r\n```\r\n\r\n### Creating Forms\r\n\r\n```python\r\nfrom reportlab.pdfgen import canvas\r\nfrom reportlab.lib.colors import black, white, lightgrey\r\n\r\nc = canvas.Canvas(\"form.pdf\")\r\n\r\nc.acroForm.textfield(\r\n    name=\"name\",\r\n    tooltip=\"Enter your name\",\r\n    x=100, y=700,\r\n    width=200, height=20,\r\n    borderColor=black,\r\n    fillColor=lightgrey,\r\n    forceBorder=True\r\n)\r\n\r\nc.acroForm.checkbox(\r\n    name=\"agree\",\r\n    x=100, y=650,\r\n    size=20,\r\n    buttonStyle='check',\r\n    checked=False\r\n)\r\n\r\nc.acroForm.choice(\r\n    name=\"country\",\r\n    x=100, y=600,\r\n    width=150, height=20,\r\n    options=[(\"United States\", \"US\"), (\"Canada\", \"CA\")],\r\n    forceBorder=True\r\n)\r\n\r\nc.save()\r\n```\r\n\r\n**Detailed PDF features reference:** See `references/pdf_features.md` for forms, links, bookmarks, encryption, and metadata.\r\n\r\n### Headers and Footers\r\n\r\nFor Platypus documents, use page callbacks:\r\n\r\n```python\r\nfrom reportlab.platypus import BaseDocTemplate, PageTemplate, Frame\r\n\r\ndef add_header_footer(canvas, doc):\r\n    \"\"\"Called on each page\"\"\"\r\n    canvas.saveState()\r\n\r\n    # Header\r\n    canvas.setFont('Helvetica', 9)\r\n    canvas.drawString(inch, height - 0.5*inch, \"Document Title\")\r\n\r\n    # Footer\r\n    canvas.drawRightString(width - inch, 0.5*inch, f\"Page {doc.page}\")\r\n\r\n    canvas.restoreState()\r\n\r\ndoc = BaseDocTemplate(\"output.pdf\")\r\nframe = Frame(doc.leftMargin, doc.bottomMargin, doc.width, doc.height, id='normal')\r\ntemplate = PageTemplate(id='normal', frames=[frame], onPage=add_header_footer)\r\ndoc.addPageTemplates([template])\r\n\r\n\r\nThis skill includes helper scripts for common tasks:\r\n\r\n### Quick Document Generator\r\n\r\nUse `scripts/quick_document.py` for rapid document creation:\r\n\r\n```python\r\nfrom scripts.quick_document import create_simple_document, create_styled_table\r\n\r\ncontent = [\r\n    {'type': 'heading', 'content': 'Introduction'},\r\n    {'type': 'paragraph', 'content': 'Your text here...'},\r\n    {'type': 'bullet', 'content': 'Bullet point'},\r\n]\r\n\r\ncreate_simple_document(\"output.pdf\", \"My Document\", content_blocks=content)\r\n\r\n\r\n### Coordinate System (Canvas)\r\n- Origin (0, 0) is **lower-left corner** (not top-left)\r\n- Y-axis points **upward**\r\n- Units are in **points** (72 points = 1 inch)\r\n- Always specify page size explicitly\r\n\r\n```python\r\nfrom reportlab.lib.pagesizes import letter\r\nfrom reportlab.lib.units import inch\r\n\r\nwidth, height = letter\r\nmargin = inch\r\n\r\ny_top = height - margin\r\n\r\ny_bottom = margin\r\n```\r\n\r\n### Choosing Page Size\r\n\r\n```python\r\nfrom reportlab.lib.pagesizes import letter, A4, landscape\r\n\r\npagesize=letter\r\n\r\npagesize=A4\r\n\r\npagesize=landscape(letter)\r\n\r\npagesize=(6*inch, 9*inch)\r\n```\r\n\r\n### Performance Tips\r\n\r\n1. **Use `drawImage()` over `drawInlineImage()`** - caches images for reuse\r\n2. **Enable compression for large files:** `canvas.Canvas(\"file.pdf\", pageCompression=1)`\r\n3. **Reuse styles** - create once, use throughout document\r\n4. **Use Forms/XObjects** for repeated graphics\r\n\r\n### Common Patterns\r\n\r\n**Centering text on Canvas:**\r\n```python\r\ntext = \"Centered Text\"\r\ntext_width = c.stringWidth(text, \"Helvetica\", 12)\r\nx = (width - text_width) / 2\r\nc.drawString(x, y, text)\r\n\r\n\r\n```bash\r\npip install reportlab\r\n\r\npip install pillow\r\n\r\npip install reportlab[renderPM]",
  "name": "reportlab",
  "id": "scientific-pkg-reportlab",
  "sections": {
    "Reference Documentation": "Comprehensive API references organized by feature:\r\n\r\n- **`references/canvas_api.md`** - Low-level Canvas: drawing primitives, coordinates, transformations, state management, images, paths\r\n- **`references/platypus_guide.md`** - High-level Platypus: document templates, frames, flowables, page layouts, TOC\r\n- **`references/text_and_fonts.md`** - Text formatting: paragraph styles, inline markup, custom fonts, Asian languages, bullets, sequences\r\n- **`references/tables_reference.md`** - Tables: creation, styling, cell spanning, borders, alignment, colors, gradients\r\n- **`references/charts_reference.md`** - Charts: all chart types, data handling, axes, legends, colors, rendering\r\n- **`references/barcodes_reference.md`** - Barcodes: Code128, QR codes, EAN, UPC, postal codes, and 20+ formats\r\n- **`references/pdf_features.md`** - PDF features: links, bookmarks, forms, encryption, metadata, page transitions",
    "Best Practices": "c.drawCentredString(width/2, y, text)\r\n```\r\n\r\n**Page breaks in Platypus:**\r\n```python\r\nfrom reportlab.platypus import PageBreak\r\n\r\nstory.append(PageBreak())\r\n```\r\n\r\n**Keep content together (no split):**\r\n```python\r\nfrom reportlab.platypus import KeepTogether\r\n\r\nstory.append(KeepTogether([\r\n    heading,\r\n    paragraph1,\r\n    paragraph2,\r\n]))\r\n```\r\n\r\n**Alternate row colors:**\r\n```python\r\nstyle = TableStyle([\r\n    ('ROWBACKGROUNDS', (0, 1), (-1, -1), [colors.white, colors.lightgrey]),\r\n])\r\n```",
    "Common Tasks": "doc.build(story)\r\n```",
    "Troubleshooting": "**Text overlaps or disappears:**\r\n- Check Y-coordinates - remember origin is bottom-left\r\n- Ensure text fits within page bounds\r\n- Verify `leading` (line spacing) is greater than `fontSize`\r\n\r\n**Table doesn't fit on page:**\r\n- Reduce column widths\r\n- Decrease font size\r\n- Use landscape orientation\r\n- Enable table splitting with `repeatRows`\r\n\r\n**Barcode not scanning:**\r\n- Increase `barHeight` (try 0.5 inch minimum)\r\n- Set `quiet=1` for quiet zones\r\n- Test print quality (300+ DPI recommended)\r\n- Validate data format for barcode type\r\n\r\n**Font not found:**\r\n- Register TrueType fonts with `pdfmetrics.registerFont()`\r\n- Use font family name exactly as registered\r\n- Check font file path is correct\r\n\r\n**Images have white background:**\r\n- Use `mask` parameter to make white transparent\r\n- Provide RGB range to mask: `mask=[255,255,255,255,255,255]`\r\n- Or use PNG with alpha channel",
    "Overview": "ReportLab is a powerful Python library for programmatic PDF generation. Create anything from simple documents to complex reports with tables, charts, images, and interactive forms.\r\n\r\n**Two main approaches:**\r\n- **Canvas API** (low-level): Direct drawing with coordinate-based positioning - use for precise layouts\r\n- **Platypus** (high-level): Flowing document layout with automatic page breaks - use for multi-page documents\r\n\r\n**Core capabilities:**\r\n- Text with rich formatting and custom fonts\r\n- Tables with complex styling and cell spanning\r\n- Charts (bar, line, pie, area, scatter)\r\n- Barcodes and QR codes (Code128, EAN, QR, etc.)\r\n- Images with transparency\r\n- PDF features (links, bookmarks, forms, encryption)",
    "Choosing the Right Approach": "### Use Canvas API when:\r\n- Creating labels, business cards, certificates\r\n- Precise positioning is critical (x, y coordinates)\r\n- Single-page documents or simple layouts\r\n- Drawing graphics, shapes, and custom designs\r\n- Adding barcodes or QR codes at specific locations\r\n\r\n### Use Platypus when:\r\n- Creating multi-page documents (reports, articles, books)\r\n- Content should flow automatically across pages\r\n- Need headers/footers that repeat on each page\r\n- Working with paragraphs that can split across pages\r\n- Building complex documents with table of contents\r\n\r\n### Use Both when:\r\n- Complex reports need both flowing content AND precise positioning\r\n- Adding headers/footers to Platypus documents (use `onPage` callback with Canvas)\r\n- Embedding custom graphics (Canvas) within flowing documents (Platypus)",
    "Template Examples": "Complete working examples in `assets/`:\r\n\r\n### Invoice Template\r\n\r\n`assets/invoice_template.py` - Professional invoice with:\r\n- Company and client information\r\n- Itemized table with calculations\r\n- Tax and totals\r\n- Terms and notes\r\n- Logo placement\r\n\r\n```python\r\nfrom assets.invoice_template import create_invoice\r\n\r\ncreate_invoice(\r\n    filename=\"invoice.pdf\",\r\n    invoice_number=\"INV-2024-001\",\r\n    invoice_date=\"January 15, 2024\",\r\n    due_date=\"February 15, 2024\",\r\n    company_info={'name': 'Acme Corp', 'address': '...', 'phone': '...', 'email': '...'},\r\n    client_info={'name': 'Client Name', ...},\r\n    items=[\r\n        {'description': 'Service', 'quantity': 1, 'unit_price': 500.00},\r\n        ...\r\n    ],\r\n    tax_rate=0.08,\r\n    notes=\"Thank you for your business!\",\r\n)\r\n```\r\n\r\n### Report Template\r\n\r\n`assets/report_template.py` - Multi-page business report with:\r\n- Cover page\r\n- Table of contents\r\n- Multiple sections with subsections\r\n- Charts and tables\r\n- Headers and footers\r\n\r\n```python\r\nfrom assets.report_template import create_report\r\n\r\nreport_data = {\r\n    'title': 'Quarterly Report',\r\n    'subtitle': 'Q4 2023',\r\n    'author': 'Analytics Team',\r\n    'sections': [\r\n        {\r\n            'title': 'Executive Summary',\r\n            'content': 'Report content...',\r\n            'table_data': {...},\r\n            'chart_data': {...}\r\n        },\r\n        ...\r\n    ]\r\n}\r\n\r\ncreate_report(\"report.pdf\", report_data)\r\n```",
    "Installation": "```",
    "Example Workflows": "### Creating an Invoice\r\n\r\n1. Start with invoice template from `assets/invoice_template.py`\r\n2. Customize company info, logo path\r\n3. Add items with descriptions, quantities, prices\r\n4. Set tax rate if applicable\r\n5. Add notes and payment terms\r\n6. Generate PDF\r\n\r\n### Creating a Report\r\n\r\n1. Start with report template from `assets/report_template.py`\r\n2. Define sections with titles and content\r\n3. Add tables for data using `create_styled_table()`\r\n4. Add charts using graphics framework\r\n5. Build with `doc.multiBuild(story)` for TOC\r\n\r\n### Creating a Certificate\r\n\r\n1. Use Canvas API for precise positioning\r\n2. Load custom fonts for elegant typography\r\n3. Add border graphics or image background\r\n4. Position text elements (name, date, achievement)\r\n5. Optional: Add QR code for verification\r\n\r\n### Creating Labels with Barcodes\r\n\r\n1. Use Canvas with custom page size (label dimensions)\r\n2. Calculate grid positions for multiple labels per page\r\n3. Draw label content (text, images)\r\n4. Add barcode at specific position\r\n5. Use `showPage()` between labels or grids",
    "Helper Scripts": "data = [['Header1', 'Header2'], ['Data1', 'Data2']]\r\ntable = create_styled_table(data, style_name='striped')  # 'default', 'striped', 'minimal', 'report'\r\n```",
    "Quick Start Examples": "doc.build(story)\r\n```",
    "When to Use This Skill": "This skill should be used when:\r\n- Generating PDF documents programmatically\r\n- Creating invoices, receipts, or billing documents\r\n- Building reports with tables and charts\r\n- Generating certificates, badges, or credentials\r\n- Creating shipping labels or product labels with barcodes\r\n- Designing forms or fillable PDFs\r\n- Producing multi-page documents with consistent formatting\r\n- Converting data to PDF format for archival or distribution\r\n- Creating custom layouts that require precise positioning\r\n\r\nThis skill provides comprehensive guidance for all ReportLab capabilities, from simple documents to complex multi-page reports with charts, tables, and interactive elements."
  }
}
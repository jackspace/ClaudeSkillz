{
  "description": "Browser automation, debugging, and performance analysis using Puppeteer CLI scripts. Use for automating browsers, taking screenshots, analyzing performance, monitoring network traffic, web scraping, form automation, and JavaScript debugging.",
  "metadata": {
    "license": "Apache-2.0"
  },
  "references": {
    "files": [
      "references/cdp-domains.md",
      "references/performance-guide.md",
      "references/puppeteer-reference.md"
    ]
  },
  "content": "Browser automation via executable Puppeteer scripts. All scripts output JSON for easy parsing.\r\n\r\n\r\n**CRITICAL**: Always check `pwd` before running scripts.\r\n\r\n### Installation\r\n\r\n#### Step 1: Install System Dependencies (Linux/WSL only)\r\n\r\nOn Linux/WSL, Chrome requires system libraries. Install them first:\r\n\r\n```bash\r\npwd  # Should show current working directory\r\ncd .claude/skills/chrome-devtools/scripts\r\n./install-deps.sh  # Auto-detects OS and installs required libs\r\n```\r\n\r\nSupports: Ubuntu, Debian, Fedora, RHEL, CentOS, Arch, Manjaro\r\n\r\n**macOS/Windows**: Skip this step (dependencies bundled with Chrome)\r\n\r\n#### Step 2: Install Node Dependencies\r\n\r\n```bash\r\nnpm install  # Installs puppeteer, debug, yargs\r\n```\r\n\r\n#### Step 3: Install ImageMagick (Optional, Recommended)\r\n\r\nImageMagick enables automatic screenshot compression to keep files under 5MB:\r\n\r\n**macOS:**\r\n```bash\r\nbrew install imagemagick\r\n```\r\n\r\n**Ubuntu/Debian/WSL:**\r\n```bash\r\nsudo apt-get install imagemagick\r\n```\r\n\r\n**Windows:**\r\n```powershell\r\nchoco install imagemagick\r\n\r\nscoop install imagemagick\r\n\r\nwinget install ImageMagick.ImageMagick\r\n\r\n```\r\n\r\n**Fedora/RHEL/CentOS:**\r\n```bash\r\nsudo dnf install ImageMagick\r\nsudo yum install ImageMagick\r\n```\r\n\r\n**Arch/Manjaro:**\r\n```bash\r\nsudo pacman -S imagemagick\r\n```\r\n\r\n**Verify installation:**\r\n```bash\r\nmagick -version  # or: convert -version\r\n\r\nmagick -version\r\n```\r\n\r\nWithout ImageMagick, screenshots >5MB will not be compressed (may fail to load in Gemini/Claude).\r\n\r\n### Test\r\n```bash\r\nnode navigate.js --url https://example.com\r\n\r\n### Single Command\r\n```bash\r\npwd  # Should show current working directory\r\ncd .claude/skills/chrome-devtools/scripts\r\nnode screenshot.js --url https://example.com --output ./docs/screenshots/page.png\r\n```\r\n**Important**: Always save screenshots to `./docs/screenshots` directory.\r\n\r\n### Automatic Image Compression\r\nScreenshots are **automatically compressed** if they exceed 5MB to ensure compatibility with Gemini API and Claude Code (which have 5MB limits). This uses ImageMagick internally:\r\n\r\n```bash\r\nnode screenshot.js --url https://example.com --output page.png\r\n\r\nnode screenshot.js --url https://example.com --output page.png --max-size 3\r\n\r\nnode screenshot.js --url https://example.com --output page.png --no-compress\r\n```\r\n\r\n**Compression behavior:**\r\n- PNG: Resizes to 90% + quality 85 (or 75% + quality 70 if still too large)\r\n- JPEG: Quality 80 + progressive encoding (or quality 60 if still too large)\r\n- Other formats: Converted to JPEG with compression\r\n- Requires ImageMagick installed (see imagemagick skill)\r\n\r\n**Output includes compression info:**\r\n```json\r\n{\r\n  \"success\": true,\r\n  \"output\": \"/path/to/page.png\",\r\n  \"compressed\": true,\r\n  \"originalSize\": 8388608,\r\n  \"size\": 3145728,\r\n  \"compressionRatio\": \"62.50%\",\r\n  \"url\": \"https://example.com\"\r\n}\r\n```\r\n\r\n### Chain Commands (reuse browser)\r\n```bash\r\nnode navigate.js --url https://example.com/login --close false\r\nnode fill.js --selector \"#email\" --value \"user@example.com\" --close false\r\nnode fill.js --selector \"#password\" --value \"secret\" --close false\r\nnode click.js --selector \"button[type=submit]\"\r\n```\r\n\r\n### Parse JSON Output\r\n```bash\r\nnode performance.js --url https://example.com | jq '.vitals.LCP'\r\n\r\n\r\n### Working Directory Verification\r\n\r\nBEFORE executing any script:\r\n1. Check current working directory with `pwd`\r\n2. Verify in `.claude/skills/chrome-devtools/scripts/` directory\r\n3. If wrong directory, `cd` to correct location\r\n4. Use absolute paths for all output files\r\n\r\nExample:\r\n```bash\r\npwd  # Should show: .../chrome-devtools/scripts\r\ncd .claude/skills/chrome-devtools/scripts\r\n```\r\n\r\n### Output Validation\r\n\r\nAFTER screenshot/capture operations:\r\n1. Verify file created with `ls -lh <output-path>`\r\n2. Read screenshot using Read tool to confirm content\r\n3. Check JSON output for success:true\r\n4. Report file size and compression status\r\n\r\nExample:\r\n```bash\r\nnode screenshot.js --url https://example.com --output ./docs/screenshots/page.png\r\nls -lh ./docs/screenshots/page.png  # Verify file exists\r\n```\r\n\r\n5. Restart working directory to the project root.\r\n\r\n### Error Recovery\r\n\r\nIf script fails:\r\n1. Check error message for selector issues\r\n2. Use snapshot.js to discover correct selectors\r\n3. Try XPath selector if CSS selector fails\r\n4. Verify element is visible and interactive\r\n\r\nExample:\r\n```bash\r\nnode click.js --url https://example.com --selector \".btn-submit\"\r\n\r\nnode snapshot.js --url https://example.com | jq '.elements[] | select(.tagName==\"BUTTON\")'",
  "name": "chrome-devtools",
  "id": "chrome-devtools_mrgoonie",
  "sections": {
    "Quick Start": "```",
    "Reference Documentation": "Detailed guides available in `./references/`:\r\n- [CDP Domains Reference](./references/cdp-domains.md) - 47 Chrome DevTools Protocol domains\r\n- [Puppeteer Quick Reference](./references/puppeteer-reference.md) - Complete Puppeteer API patterns\r\n- [Performance Analysis Guide](./references/performance-guide.md) - Core Web Vitals optimization",
    "Finding Elements": "Use `snapshot.js` to discover selectors:\r\n```bash\r\nnode snapshot.js --url https://example.com | jq '.elements[] | {tagName, text, selector}'\r\n```",
    "Usage Patterns": "node network.js --url https://example.com --output /tmp/requests.json\r\n```",
    "Output Format": "All scripts output JSON to stdout:\r\n```json\r\n{\r\n  \"success\": true,\r\n  \"url\": \"https://example.com\",\r\n  ... // script-specific data\r\n}\r\n```\r\n\r\nErrors go to stderr:\r\n```json\r\n{\r\n  \"success\": false,\r\n  \"error\": \"Error message\"\r\n}\r\n```",
    "External Resources": "- [Puppeteer Documentation](https://pptr.dev/)\r\n- [Chrome DevTools Protocol](https://chromedevtools.github.io/devtools-protocol/)\r\n- [Scripts README](./scripts/README.md)",
    "Available Scripts": "All scripts are in `.claude/skills/chrome-devtools/scripts/`\r\n\r\n**CRITICAL**: Always check `pwd` before running scripts.\r\n\r\n### Script Usage\r\n- `./scripts/README.md`\r\n\r\n### Core Automation\r\n- `navigate.js` - Navigate to URLs\r\n- `screenshot.js` - Capture screenshots (full page or element)\r\n- `click.js` - Click elements\r\n- `fill.js` - Fill form fields\r\n- `evaluate.js` - Execute JavaScript in page context\r\n\r\n### Analysis & Monitoring\r\n- `snapshot.js` - Extract interactive elements with metadata\r\n- `console.js` - Monitor console messages/errors\r\n- `network.js` - Track HTTP requests/responses\r\n- `performance.js` - Measure Core Web Vitals + record traces",
    "Advanced Usage": "### Custom Scripts\r\nCreate custom scripts using shared library:\r\n```javascript\r\nimport { getBrowser, getPage, closeBrowser, outputJSON } from './lib/browser.js';\r\n// Your automation logic\r\n```\r\n\r\n### Direct CDP Access\r\n```javascript\r\nconst client = await page.createCDPSession();\r\nawait client.send('Emulation.setCPUThrottlingRate', { rate: 4 });\r\n```\r\n\r\nSee reference documentation for advanced patterns and complete API coverage.",
    "Troubleshooting": "### Common Errors\r\n\r\n**\"Cannot find package 'puppeteer'\"**\r\n- Run: `npm install` in the scripts directory\r\n\r\n**\"error while loading shared libraries: libnss3.so\"** (Linux/WSL)\r\n- Missing system dependencies\r\n- Fix: Run `./install-deps.sh` in scripts directory\r\n- Manual install: `sudo apt-get install -y libnss3 libnspr4 libasound2t64 libatk1.0-0 libatk-bridge2.0-0 libcups2 libdrm2 libxkbcommon0 libxcomposite1 libxdamage1 libxfixes3 libxrandr2 libgbm1`\r\n\r\n**\"Failed to launch the browser process\"**\r\n- Check system dependencies installed (Linux/WSL)\r\n- Verify Chrome downloaded: `ls ~/.cache/puppeteer`\r\n- Try: `npm rebuild` then `npm install`\r\n\r\n**Chrome not found**\r\n- Puppeteer auto-downloads Chrome during `npm install`\r\n- If failed, manually trigger: `npx puppeteer browsers install chrome`\r\n\r\n### Script Issues\r\n\r\n**Element not found**\r\n- Get snapshot first to find correct selector: `node snapshot.js --url <url>`\r\n\r\n**Script hangs**\r\n- Increase timeout: `--timeout 60000`\r\n- Change wait strategy: `--wait-until load` or `--wait-until domcontentloaded`\r\n\r\n**Blank screenshot**\r\n- Wait for page load: `--wait-until networkidle2`\r\n- Increase timeout: `--timeout 30000`\r\n\r\n**Permission denied on scripts**\r\n- Make executable: `chmod +x *.sh`\r\n\r\n**Screenshot too large (>5MB)**\r\n- Install ImageMagick for automatic compression\r\n- Manually set lower threshold: `--max-size 3`\r\n- Use JPEG format instead of PNG: `--format jpeg --quality 80`\r\n- Capture specific element instead of full page: `--selector .main-content`\r\n\r\n**Compression not working**\r\n- Verify ImageMagick installed: `magick -version` or `convert -version`\r\n- Check file was actually compressed in output JSON: `\"compressed\": true`\r\n- For very large pages, use `--selector` to capture only needed area",
    "Common Workflows": "### Web Scraping\r\n```bash\r\nnode evaluate.js --url https://example.com --script \"\r\n  Array.from(document.querySelectorAll('.item')).map(el => ({\r\n    title: el.querySelector('h2')?.textContent,\r\n    link: el.querySelector('a')?.href\r\n  }))\r\n\" | jq '.result'\r\n```\r\n\r\n### Performance Testing\r\n```bash\r\nPERF=$(node performance.js --url https://example.com)\r\nLCP=$(echo $PERF | jq '.vitals.LCP')\r\nif (( $(echo \"$LCP < 2500\" | bc -l) )); then\r\n  echo \"✓ LCP passed: ${LCP}ms\"\r\nelse\r\n  echo \"✗ LCP failed: ${LCP}ms\"\r\nfi\r\n```\r\n\r\n### Form Automation\r\n```bash\r\nnode fill.js --url https://example.com --selector \"#search\" --value \"query\" --close false\r\nnode click.js --selector \"button[type=submit]\"\r\n```\r\n\r\n### Error Monitoring\r\n```bash\r\nnode console.js --url https://example.com --types error,warn --duration 5000 | jq '.messageCount'\r\n```",
    "Execution Protocol": "node click.js --url https://example.com --selector \"//button[contains(text(),'Submit')]\"\r\n```\r\n\r\n### Common Mistakes\r\n\r\n❌ Wrong working directory → output files go to wrong location\r\n❌ Skipping output validation → silent failures\r\n❌ Using complex CSS selectors without testing → selector errors\r\n❌ Not checking element visibility → timeout errors\r\n\r\n✅ Always verify `pwd` before running scripts\r\n✅ Always validate output after screenshots\r\n✅ Use snapshot.js to discover selectors\r\n✅ Test selectors with simple commands first",
    "Script Options": "All scripts support:\r\n- `--headless false` - Show browser window\r\n- `--close false` - Keep browser open for chaining\r\n- `--timeout 30000` - Set timeout (milliseconds)\r\n- `--wait-until networkidle2` - Wait strategy\r\n\r\nSee `./scripts/README.md` for complete options."
  }
}
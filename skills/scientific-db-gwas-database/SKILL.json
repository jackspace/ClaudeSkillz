{
  "description": "\"Query NHGRI-EBI GWAS Catalog for SNP-trait associations. Search variants by rs ID, disease/trait, gene, retrieve p-values and summary statistics, for genetic epidemiology and polygenic risk scores.\"",
  "references": {
    "files": [
      "references/api_reference.md"
    ]
  },
  "content": "### 1. Understanding GWAS Catalog Data Structure\r\n\r\nThe GWAS Catalog is organized around four core entities:\r\n\r\n- **Studies**: GWAS publications with metadata (PMID, author, cohort details)\r\n- **Associations**: SNP-trait associations with statistical evidence (p ≤ 5×10⁻⁸)\r\n- **Variants**: Genetic markers (SNPs) with genomic coordinates and alleles\r\n- **Traits**: Phenotypes and diseases (mapped to EFO ontology terms)\r\n\r\n**Key Identifiers:**\r\n- Study accessions: `GCST` IDs (e.g., GCST001234)\r\n- Variant IDs: `rs` numbers (e.g., rs7903146) or `variant_id` format\r\n- Trait IDs: EFO terms (e.g., EFO_0001360 for type 2 diabetes)\r\n- Gene symbols: HGNC approved names (e.g., TCF7L2)\r\n\r\n### 2. Web Interface Searches\r\n\r\nThe web interface at https://www.ebi.ac.uk/gwas/ supports multiple search modes:\r\n\r\n**By Variant (rs ID):**\r\n```\r\nrs7903146\r\n```\r\nReturns all trait associations for this SNP.\r\n\r\n**By Disease/Trait:**\r\n```\r\ntype 2 diabetes\r\nParkinson disease\r\nbody mass index\r\n```\r\nReturns all associated genetic variants.\r\n\r\n**By Gene:**\r\n```\r\nAPOE\r\nTCF7L2\r\n```\r\nReturns variants in or near the gene region.\r\n\r\n**By Chromosomal Region:**\r\n```\r\n10:114000000-115000000\r\n```\r\nReturns variants in the specified genomic interval.\r\n\r\n**By Publication:**\r\n```\r\nPMID:20581827\r\nAuthor: McCarthy MI\r\nGCST001234\r\n```\r\nReturns study details and all reported associations.\r\n\r\n### 3. REST API Access\r\n\r\nThe GWAS Catalog provides two REST APIs for programmatic access:\r\n\r\n**Base URLs:**\r\n- GWAS Catalog API: `https://www.ebi.ac.uk/gwas/rest/api`\r\n- Summary Statistics API: `https://www.ebi.ac.uk/gwas/summary-statistics/api`\r\n\r\n**API Documentation:**\r\n- Main API docs: https://www.ebi.ac.uk/gwas/rest/docs/api\r\n- Summary stats docs: https://www.ebi.ac.uk/gwas/summary-statistics/docs/\r\n\r\n**Core Endpoints:**\r\n\r\n1. **Studies endpoint** - `/studies/{accessionID}`\r\n   ```python\r\n   import requests\r\n\r\n   # Get a specific study\r\n   url = \"https://www.ebi.ac.uk/gwas/rest/api/studies/GCST001795\"\r\n   response = requests.get(url, headers={\"Content-Type\": \"application/json\"})\r\n   study = response.json()\r\n   ```\r\n\r\n2. **Associations endpoint** - `/associations`\r\n   ```python\r\n   # Find associations for a variant\r\n   variant = \"rs7903146\"\r\n   url = f\"https://www.ebi.ac.uk/gwas/rest/api/singleNucleotidePolymorphisms/{variant}/associations\"\r\n   params = {\"projection\": \"associationBySnp\"}\r\n   response = requests.get(url, params=params, headers={\"Content-Type\": \"application/json\"})\r\n   associations = response.json()\r\n   ```\r\n\r\n3. **Variants endpoint** - `/singleNucleotidePolymorphisms/{rsID}`\r\n   ```python\r\n   # Get variant details\r\n   url = \"https://www.ebi.ac.uk/gwas/rest/api/singleNucleotidePolymorphisms/rs7903146\"\r\n   response = requests.get(url, headers={\"Content-Type\": \"application/json\"})\r\n   variant_info = response.json()\r\n   ```\r\n\r\n4. **Traits endpoint** - `/efoTraits/{efoID}`\r\n   ```python\r\n   # Get trait information\r\n   url = \"https://www.ebi.ac.uk/gwas/rest/api/efoTraits/EFO_0001360\"\r\n   response = requests.get(url, headers={\"Content-Type\": \"application/json\"})\r\n   trait_info = response.json()\r\n   ```\r\n\r\n### 4. Query Examples and Patterns\r\n\r\n**Example 1: Find all associations for a disease**\r\n```python\r\nimport requests\r\n\r\ntrait = \"EFO_0001360\"  # Type 2 diabetes\r\nbase_url = \"https://www.ebi.ac.uk/gwas/rest/api\"\r\n\r\nurl = f\"{base_url}/efoTraits/{trait}/associations\"\r\nresponse = requests.get(url, headers={\"Content-Type\": \"application/json\"})\r\nassociations = response.json()\r\n\r\nfor assoc in associations.get('_embedded', {}).get('associations', []):\r\n    variant = assoc.get('rsId')\r\n    pvalue = assoc.get('pvalue')\r\n    risk_allele = assoc.get('strongestAllele')\r\n    print(f\"{variant}: p={pvalue}, risk allele={risk_allele}\")\r\n```\r\n\r\n**Example 2: Get variant information and all trait associations**\r\n```python\r\nimport requests\r\n\r\nvariant = \"rs7903146\"\r\nbase_url = \"https://www.ebi.ac.uk/gwas/rest/api\"\r\n\r\nurl = f\"{base_url}/singleNucleotidePolymorphisms/{variant}\"\r\nresponse = requests.get(url, headers={\"Content-Type\": \"application/json\"})\r\nvariant_data = response.json()\r\n\r\nurl = f\"{base_url}/singleNucleotidePolymorphisms/{variant}/associations\"\r\nparams = {\"projection\": \"associationBySnp\"}\r\nresponse = requests.get(url, params=params, headers={\"Content-Type\": \"application/json\"})\r\nassociations = response.json()\r\n\r\nfor assoc in associations.get('_embedded', {}).get('associations', []):\r\n    trait = assoc.get('efoTrait')\r\n    pvalue = assoc.get('pvalue')\r\n    print(f\"Trait: {trait}, p-value: {pvalue}\")\r\n```\r\n\r\n**Example 3: Access summary statistics**\r\n```python\r\nimport requests\r\n\r\nbase_url = \"https://www.ebi.ac.uk/gwas/summary-statistics/api\"\r\n\r\ntrait = \"EFO_0001360\"  # Type 2 diabetes\r\np_upper = \"0.000000001\"  # p < 1e-9\r\nurl = f\"{base_url}/traits/{trait}/associations\"\r\nparams = {\r\n    \"p_upper\": p_upper,\r\n    \"size\": 100  # Number of results\r\n}\r\nresponse = requests.get(url, params=params)\r\nresults = response.json()\r\n\r\nfor hit in results.get('_embedded', {}).get('associations', []):\r\n    variant_id = hit.get('variant_id')\r\n    chromosome = hit.get('chromosome')\r\n    position = hit.get('base_pair_location')\r\n    pvalue = hit.get('p_value')\r\n    print(f\"{chromosome}:{position} ({variant_id}): p={pvalue}\")\r\n```\r\n\r\n**Example 4: Query by chromosomal region**\r\n```python\r\nimport requests\r\n\r\nchromosome = \"10\"\r\nstart_pos = 114000000\r\nend_pos = 115000000\r\n\r\nbase_url = \"https://www.ebi.ac.uk/gwas/rest/api\"\r\nurl = f\"{base_url}/singleNucleotidePolymorphisms/search/findByChromBpLocationRange\"\r\nparams = {\r\n    \"chrom\": chromosome,\r\n    \"bpStart\": start_pos,\r\n    \"bpEnd\": end_pos\r\n}\r\nresponse = requests.get(url, params=params, headers={\"Content-Type\": \"application/json\"})\r\nvariants_in_region = response.json()\r\n```\r\n\r\n### 5. Working with Summary Statistics\r\n\r\nThe GWAS Catalog hosts full summary statistics for many studies, providing access to all tested variants (not just genome-wide significant hits).\r\n\r\n**Access Methods:**\r\n1. **FTP download**: http://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/\r\n2. **REST API**: Query-based access to summary statistics\r\n3. **Web interface**: Browse and download via the website\r\n\r\n**Summary Statistics API Features:**\r\n- Filter by chromosome, position, p-value\r\n- Query specific variants across studies\r\n- Retrieve effect sizes and allele frequencies\r\n- Access harmonized and standardized data\r\n\r\n**Example: Download summary statistics for a study**\r\n```python\r\nimport requests\r\nimport gzip\r\n\r\nbase_url = \"https://www.ebi.ac.uk/gwas/summary-statistics/api\"\r\nurl = f\"{base_url}/studies/GCST001234\"\r\nresponse = requests.get(url)\r\nstudy_info = response.json()\r\n\r\n```\r\n\r\n### 6. Data Integration and Cross-referencing\r\n\r\nThe GWAS Catalog provides links to external resources:\r\n\r\n**Genomic Databases:**\r\n- Ensembl: Gene annotations and variant consequences\r\n- dbSNP: Variant identifiers and population frequencies\r\n- gnomAD: Population allele frequencies\r\n\r\n**Functional Resources:**\r\n- Open Targets: Target-disease associations\r\n- PGS Catalog: Polygenic risk scores\r\n- UCSC Genome Browser: Genomic context\r\n\r\n**Phenotype Resources:**\r\n- EFO (Experimental Factor Ontology): Standardized trait terms\r\n- OMIM: Disease gene relationships\r\n- Disease Ontology: Disease hierarchies\r\n\r\n**Following Links in API Responses:**\r\n```python\r\nimport requests\r\n\r\nresponse = requests.get(\"https://www.ebi.ac.uk/gwas/rest/api/studies/GCST001234\")\r\nstudy = response.json()\r\n\r\n\r\nComplete workflow for querying and analyzing GWAS data:\r\n\r\n```python\r\nimport requests\r\nimport pandas as pd\r\nfrom time import sleep\r\n\r\ndef query_gwas_catalog(trait_id, p_threshold=5e-8):\r\n    \"\"\"\r\n    Query GWAS Catalog for trait associations\r\n\r\n    Args:\r\n        trait_id: EFO trait identifier (e.g., 'EFO_0001360')\r\n        p_threshold: P-value threshold for filtering\r\n\r\n    Returns:\r\n        pandas DataFrame with association results\r\n    \"\"\"\r\n    base_url = \"https://www.ebi.ac.uk/gwas/rest/api\"\r\n    url = f\"{base_url}/efoTraits/{trait_id}/associations\"\r\n\r\n    headers = {\"Content-Type\": \"application/json\"}\r\n    results = []\r\n    page = 0\r\n\r\n    while True:\r\n        params = {\"page\": page, \"size\": 100}\r\n        response = requests.get(url, params=params, headers=headers)\r\n\r\n        if response.status_code != 200:\r\n            break\r\n\r\n        data = response.json()\r\n        associations = data.get('_embedded', {}).get('associations', [])\r\n\r\n        if not associations:\r\n            break\r\n\r\n        for assoc in associations:\r\n            pvalue = assoc.get('pvalue')\r\n            if pvalue and float(pvalue) <= p_threshold:\r\n                results.append({\r\n                    'variant': assoc.get('rsId'),\r\n                    'pvalue': pvalue,\r\n                    'risk_allele': assoc.get('strongestAllele'),\r\n                    'or_beta': assoc.get('orPerCopyNum') or assoc.get('betaNum'),\r\n                    'trait': assoc.get('efoTrait'),\r\n                    'pubmed_id': assoc.get('pubmedId')\r\n                })\r\n\r\n        page += 1\r\n        sleep(0.1)  # Rate limiting\r\n\r\n    return pd.DataFrame(results)",
  "name": "gwas-database",
  "id": "scientific-db-gwas-database",
  "sections": {
    "Best Practices": "### Query Strategy\r\n- Start with web interface to identify relevant EFO terms and study accessions\r\n- Use API for bulk data extraction and automated analyses\r\n- Implement pagination handling for large result sets\r\n- Cache API responses to minimize redundant requests\r\n\r\n### Data Interpretation\r\n- Always check p-value thresholds (genome-wide: 5×10⁻⁸)\r\n- Review ancestry information for population applicability\r\n- Consider sample size when assessing evidence strength\r\n- Check for replication across independent studies\r\n- Be aware of winner's curse in effect size estimates\r\n\r\n### Rate Limiting and Ethics\r\n- Respect API usage guidelines (no excessive requests)\r\n- Use summary statistics downloads for genome-wide analyses\r\n- Implement appropriate delays between API calls\r\n- Cache results locally when performing iterative analyses\r\n- Cite the GWAS Catalog in publications\r\n\r\n### Data Quality Considerations\r\n- GWAS Catalog curates published associations (may contain inconsistencies)\r\n- Effect sizes reported as published (may need harmonization)\r\n- Some studies report conditional or joint associations\r\n- Check for study overlap when combining results\r\n- Be aware of ascertainment and selection biases",
    "Python Integration Example": "df = query_gwas_catalog('EFO_0001360')  # Type 2 diabetes\r\nprint(df.head())\r\nprint(f\"\\nTotal associations: {len(df)}\")\r\nprint(f\"Unique variants: {df['variant'].nunique()}\")\r\n```",
    "Additional Resources": "- **GWAS Catalog website**: https://www.ebi.ac.uk/gwas/\r\n- **Documentation**: https://www.ebi.ac.uk/gwas/docs\r\n- **API documentation**: https://www.ebi.ac.uk/gwas/rest/docs/api\r\n- **Summary Statistics API**: https://www.ebi.ac.uk/gwas/summary-statistics/docs/\r\n- **FTP site**: http://ftp.ebi.ac.uk/pub/databases/gwas/\r\n- **Training materials**: https://github.com/EBISPOT/GWAS_Catalog-workshop\r\n- **PGS Catalog** (polygenic scores): https://www.pgscatalog.org/\r\n- **Help and support**: gwas-info@ebi.ac.uk",
    "Important Notes": "### Data Updates\r\n- The GWAS Catalog is updated regularly with new publications\r\n- Re-run queries periodically for comprehensive coverage\r\n- Summary statistics are added as studies release data\r\n- EFO mappings may be updated over time\r\n\r\n### Citation Requirements\r\nWhen using GWAS Catalog data, cite:\r\n- Sollis E, et al. (2023) The NHGRI-EBI GWAS Catalog: knowledgebase and deposition resource. Nucleic Acids Research. PMID: 37953337\r\n- Include access date and version when available\r\n- Cite original studies when discussing specific findings\r\n\r\n### Limitations\r\n- Not all GWAS publications are included (curation criteria apply)\r\n- Full summary statistics available for subset of studies\r\n- Effect sizes may require harmonization across studies\r\n- Population diversity is growing but historically limited\r\n- Some associations represent conditional or joint effects\r\n\r\n### Data Access\r\n- Web interface: Free, no registration required\r\n- REST APIs: Free, no API key needed\r\n- FTP downloads: Open access\r\n- Rate limiting applies to API (be respectful)",
    "Overview": "The GWAS Catalog is a comprehensive repository of published genome-wide association studies maintained by the National Human Genome Research Institute (NHGRI) and the European Bioinformatics Institute (EBI). The catalog contains curated SNP-trait associations from thousands of GWAS publications, including genetic variants, associated traits and diseases, p-values, effect sizes, and full summary statistics for many studies.",
    "When to Use This Skill": "This skill should be used when queries involve:\r\n\r\n- **Genetic variant associations**: Finding SNPs associated with diseases or traits\r\n- **SNP lookups**: Retrieving information about specific genetic variants (rs IDs)\r\n- **Trait/disease searches**: Discovering genetic associations for phenotypes\r\n- **Gene associations**: Finding variants in or near specific genes\r\n- **GWAS summary statistics**: Accessing complete genome-wide association data\r\n- **Study metadata**: Retrieving publication and cohort information\r\n- **Population genetics**: Exploring ancestry-specific associations\r\n- **Polygenic risk scores**: Identifying variants for risk prediction models\r\n- **Functional genomics**: Understanding variant effects and genomic context\r\n- **Systematic reviews**: Comprehensive literature synthesis of genetic associations",
    "Query Workflows": "### Workflow 1: Exploring Genetic Associations for a Disease\r\n\r\n1. **Identify the trait** using EFO terms or free text:\r\n   - Search web interface for disease name\r\n   - Note the EFO ID (e.g., EFO_0001360 for type 2 diabetes)\r\n\r\n2. **Query associations via API:**\r\n   ```python\r\n   url = f\"https://www.ebi.ac.uk/gwas/rest/api/efoTraits/{efo_id}/associations\"\r\n   ```\r\n\r\n3. **Filter by significance and population:**\r\n   - Check p-values (genome-wide significant: p ≤ 5×10⁻⁸)\r\n   - Review ancestry information in study metadata\r\n   - Filter by sample size or discovery/replication status\r\n\r\n4. **Extract variant details:**\r\n   - rs IDs for each association\r\n   - Effect alleles and directions\r\n   - Effect sizes (odds ratios, beta coefficients)\r\n   - Population allele frequencies\r\n\r\n5. **Cross-reference with other databases:**\r\n   - Look up variant consequences in Ensembl\r\n   - Check population frequencies in gnomAD\r\n   - Explore gene function and pathways\r\n\r\n### Workflow 2: Investigating a Specific Genetic Variant\r\n\r\n1. **Query the variant:**\r\n   ```python\r\n   url = f\"https://www.ebi.ac.uk/gwas/rest/api/singleNucleotidePolymorphisms/{rs_id}\"\r\n   ```\r\n\r\n2. **Retrieve all trait associations:**\r\n   ```python\r\n   url = f\"https://www.ebi.ac.uk/gwas/rest/api/singleNucleotidePolymorphisms/{rs_id}/associations\"\r\n   ```\r\n\r\n3. **Analyze pleiotropy:**\r\n   - Identify all traits associated with this variant\r\n   - Review effect directions across traits\r\n   - Look for shared biological pathways\r\n\r\n4. **Check genomic context:**\r\n   - Determine nearby genes\r\n   - Identify if variant is in coding/regulatory regions\r\n   - Review linkage disequilibrium with other variants\r\n\r\n### Workflow 3: Gene-Centric Association Analysis\r\n\r\n1. **Search by gene symbol** in web interface or:\r\n   ```python\r\n   url = f\"https://www.ebi.ac.uk/gwas/rest/api/singleNucleotidePolymorphisms/search/findByGene\"\r\n   params = {\"geneName\": gene_symbol}\r\n   ```\r\n\r\n2. **Retrieve variants in gene region:**\r\n   - Get chromosomal coordinates for gene\r\n   - Query variants in region\r\n   - Include promoter and regulatory regions (extend boundaries)\r\n\r\n3. **Analyze association patterns:**\r\n   - Identify traits associated with variants in this gene\r\n   - Look for consistent associations across studies\r\n   - Review effect sizes and directions\r\n\r\n4. **Functional interpretation:**\r\n   - Determine variant consequences (missense, regulatory, etc.)\r\n   - Check expression QTL (eQTL) data\r\n   - Review pathway and network context\r\n\r\n### Workflow 4: Systematic Review of Genetic Evidence\r\n\r\n1. **Define research question:**\r\n   - Specific trait or disease of interest\r\n   - Population considerations\r\n   - Study design requirements\r\n\r\n2. **Comprehensive variant extraction:**\r\n   - Query all associations for trait\r\n   - Set significance threshold\r\n   - Note discovery and replication studies\r\n\r\n3. **Quality assessment:**\r\n   - Review study sample sizes\r\n   - Check for population diversity\r\n   - Assess heterogeneity across studies\r\n   - Identify potential biases\r\n\r\n4. **Data synthesis:**\r\n   - Aggregate associations across studies\r\n   - Perform meta-analysis if applicable\r\n   - Create summary tables\r\n   - Generate Manhattan or forest plots\r\n\r\n5. **Export and documentation:**\r\n   - Download full association data\r\n   - Export summary statistics if needed\r\n   - Document search strategy and date\r\n   - Create reproducible analysis scripts\r\n\r\n### Workflow 5: Accessing and Analyzing Summary Statistics\r\n\r\n1. **Identify studies with summary statistics:**\r\n   - Browse summary statistics portal\r\n   - Check FTP directory listings\r\n   - Query API for available studies\r\n\r\n2. **Download summary statistics:**\r\n   ```bash\r\n   # Via FTP\r\n   wget ftp://ftp.ebi.ac.uk/pub/databases/gwas/summary_statistics/GCSTXXXXXX/harmonised/GCSTXXXXXX-harmonised.tsv.gz\r\n   ```\r\n\r\n3. **Query via API for specific variants:**\r\n   ```python\r\n   url = f\"https://www.ebi.ac.uk/gwas/summary-statistics/api/chromosomes/{chrom}/associations\"\r\n   params = {\"start\": start_pos, \"end\": end_pos}\r\n   ```\r\n\r\n4. **Process and analyze:**\r\n   - Filter by p-value thresholds\r\n   - Extract effect sizes and confidence intervals\r\n   - Perform downstream analyses (fine-mapping, colocalization, etc.)",
    "Resources": "### references/api_reference.md\r\n\r\nComprehensive API documentation including:\r\n- Detailed endpoint specifications for both APIs\r\n- Complete list of query parameters and filters\r\n- Response format specifications and field descriptions\r\n- Advanced query examples and patterns\r\n- Error handling and troubleshooting\r\n- Integration with external databases\r\n\r\nConsult this reference when:\r\n- Constructing complex API queries\r\n- Understanding response structures\r\n- Implementing pagination or batch operations\r\n- Troubleshooting API errors\r\n- Exploring advanced filtering options\r\n\r\n### Training Materials\r\n\r\nThe GWAS Catalog team provides workshop materials:\r\n- GitHub repository: https://github.com/EBISPOT/GWAS_Catalog-workshop\r\n- Jupyter notebooks with example queries\r\n- Google Colab integration for cloud execution",
    "Core Capabilities": "associations_url = study['_links']['associations']['href']\r\nassociations_response = requests.get(associations_url)\r\n```",
    "Response Formats and Data Fields": "**Key Fields in Association Records:**\r\n- `rsId`: Variant identifier (rs number)\r\n- `strongestAllele`: Risk allele for the association\r\n- `pvalue`: Association p-value\r\n- `pvalueText`: P-value as text (may include inequality)\r\n- `orPerCopyNum`: Odds ratio or beta coefficient\r\n- `betaNum`: Effect size (for quantitative traits)\r\n- `betaUnit`: Unit of measurement for beta\r\n- `range`: Confidence interval\r\n- `efoTrait`: Associated trait name\r\n- `mappedLabel`: EFO-mapped trait term\r\n\r\n**Study Metadata Fields:**\r\n- `accessionId`: GCST study identifier\r\n- `pubmedId`: PubMed ID\r\n- `author`: First author\r\n- `publicationDate`: Publication date\r\n- `ancestryInitial`: Discovery population ancestry\r\n- `ancestryReplication`: Replication population ancestry\r\n- `sampleSize`: Total sample size\r\n\r\n**Pagination:**\r\nResults are paginated (default 20 items per page). Navigate using:\r\n- `size` parameter: Number of results per page\r\n- `page` parameter: Page number (0-indexed)\r\n- `_links` in response: URLs for next/previous pages"
  }
}